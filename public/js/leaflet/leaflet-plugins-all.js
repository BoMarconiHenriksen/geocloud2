!function(a,b){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null},addLayer:function(a){if(a instanceof L.LayerGroup){var b=[];for(var c in a._layers)b.push(a._layers[c]);return this.addLayers(b)}if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this;if(!this._map)return this._needsClustering.push(a),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(a,this._maxZoom);var d=a,e=this._map.getZoom();if(a.__parent)for(;d.__parent._zoom>=e;)d=d.__parent;return this._currentShownBounds.contains(d.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,d):this._animationAddLayerNonAnimated(a,d)),this},removeLayer:function(a){if(a instanceof L.LayerGroup){var b=[];for(var c in a._layers)b.push(a._layers[c]);return this.removeLayers(b)}return a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.setOpacity&&a.setOpacity(1)),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push(a),this):(this._nonPointGroup.removeLayer(a),this)},addLayers:function(a){var b,c,d,e=this._map,f=this._featureGroup,g=this._nonPointGroup;for(b=0,c=a.length;c>b;b++)if(d=a[b],d.getLatLng){if(!this.hasLayer(d))if(e){if(this._addLayer(d,this._maxZoom),d.__parent&&2===d.__parent.getChildCount()){var h=d.__parent.getAllChildMarkers(),i=h[0]===d?h[1]:h[0];f.removeLayer(i)}}else this._needsClustering.push(d)}else g.addLayer(d);return e&&(f.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)),this},removeLayers:function(a){var b,c,d,e=this._featureGroup,f=this._nonPointGroup;if(!this._map){for(b=0,c=a.length;c>b;b++)d=a[b],this._arraySplice(this._needsClustering,d),f.removeLayer(d);return this}for(b=0,c=a.length;c>b;b++)d=a[b],d.__parent?(this._removeLayer(d,!0,!0),e.hasLayer(d)&&(e.removeLayer(d),d.setOpacity&&d.setOpacity(1))):f.removeLayer(d);return this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),e.eachLayer(function(a){a instanceof L.MarkerCluster&&a._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){delete a.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;if(this._topClusterLevel)a.extend(this._topClusterLevel._bounds);else for(var b=this._needsClustering.length-1;b>=0;b--)a.extend(this._needsClustering[b].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,b){var c,d=this._needsClustering.slice();for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(d),c=d.length-1;c>=0;c--)a.call(b,d[c]);this._nonPointGroup.eachLayer(a,b)},getLayers:function(){var a=[];return this.eachLayer(function(b){a.push(b)}),a},hasLayer:function(a){if(!a)return!1;var b,c=this._needsClustering;for(b=c.length-1;b>=0;b--)if(c[b]===a)return!0;for(c=this._needsRemoving,b=c.length-1;b>=0;b--)if(c[b]===a)return!1;return!(!a.__parent||a.__parent._group!==this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,b){var c=function(){if((a._icon||a.__parent._icon)&&!this._inZoomAnimation)if(this._map.off("moveend",c,this),this.off("animationend",c,this),a._icon)b();else if(a.__parent._icon){var d=function(){this.off("spiderfied",d,this),b()};this.on("spiderfied",d,this),a.__parent.spiderfy()}};a._icon?b():a.__parent._zoom<this._map.getZoom()?(this._map.on("moveend",c,this),a._icon||this._map.panTo(a.getLatLng())):(this._map.on("moveend",c,this),this.on("animationend",c,this),this._map.setView(a.getLatLng(),a.__parent._zoom+1),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var b,c,d;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.onAdd(a),this._nonPointGroup.onAdd(a),this._gridClusters||this._generateInitialClusters(),b=0,c=this._needsRemoving.length;c>b;b++)d=this._needsRemoving[b],this._removeLayer(d,!0);for(this._needsRemoving=[],b=0,c=this._needsClustering.length;c>b;b++)d=this._needsClustering[b],d.getLatLng?d.__parent||this._addLayer(d,this._maxZoom):this._featureGroup.addLayer(d);this._needsClustering=[],this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),this._hideCoverage(),this._featureGroup.onRemove(a),this._nonPointGroup.onRemove(a),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(a){for(var b=a;b&&!b._icon;)b=b.__parent;return b||null},_arraySplice:function(a,b){for(var c=a.length-1;c>=0;c--)if(a[c]===b)return a.splice(c,1),!0},_removeLayer:function(a,b,c){var d=this._gridClusters,e=this._gridUnclustered,f=this._featureGroup,g=this._map;if(b)for(var h=this._maxZoom;h>=0&&e[h].removeObject(a,g.project(a.getLatLng(),h));h--);var i,j=a.__parent,k=j._markers;for(this._arraySplice(k,a);j&&(j._childCount--,!(j._zoom<0));)b&&j._childCount<=1?(i=j._markers[0]===a?j._markers[1]:j._markers[0],d[j._zoom].removeObject(j,g.project(j._cLatLng,j._zoom)),e[j._zoom].addObject(i,g.project(i.getLatLng(),j._zoom)),this._arraySplice(j.__parent._childClusters,j),j.__parent._markers.push(i),i.__parent=j.__parent,j._icon&&(f.removeLayer(j),c||f.addLayer(i))):(j._recalculateBounds(),c&&j._icon||j._updateIcon()),j=j.__parent;delete a.__parent},_propagateEvent:function(a){a.layer instanceof L.MarkerCluster&&(a.type="cluster"+a.type),this.fire(a.type,a)},_defaultIconCreateFunction:function(a){var b=a.getChildCount(),c=" marker-cluster-";return c+=10>b?"small":100>b?"medium":"large",new L.DivIcon({html:"<div><span>"+b+"</span></div>",className:"marker-cluster"+c,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,b=this.options.spiderfyOnMaxZoom,c=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick;(b||d)&&this.on("clusterclick",this._zoomOrSpiderfy,this),c&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){var b=this._map;b.getMaxZoom()===b.getZoom()?this.options.spiderfyOnMaxZoom&&a.layer.spiderfy():this.options.zoomToBoundsOnClick&&a.layer.zoomToBounds()},_showCoverage:function(a){var b=this._map;this._inZoomAnimation||(this._shownPolygon&&b.removeLayer(this._shownPolygon),a.layer.getChildCount()>2&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),b.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.spiderfyOnMaxZoom,b=this.options.showCoverageOnHover,c=this.options.zoomToBoundsOnClick,d=this._map;(a||c)&&this.off("clusterclick",this._zoomOrSpiderfy,this),b&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),d.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=this._map._zoom,this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._map._zoom,a),this._currentShownBounds=a}},_generateInitialClusters:function(){var a=this._map.getMaxZoom(),b=this.options.maxClusterRadius;this.options.disableClusteringAtZoom&&(a=this.options.disableClusteringAtZoom-1),this._maxZoom=a,this._gridClusters={},this._gridUnclustered={};for(var c=a;c>=0;c--)this._gridClusters[c]=new L.DistanceGrid(b),this._gridUnclustered[c]=new L.DistanceGrid(b);this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(a,b){var c,d,e=this._gridClusters,f=this._gridUnclustered;for(this.options.singleMarkerMode&&(a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}}));b>=0;b--){c=this._map.project(a.getLatLng(),b);var g=e[b].getNearObject(c);if(g)return g._addChild(a),void(a.__parent=g);if(g=f[b].getNearObject(c)){var h=g.__parent;h&&this._removeLayer(g,!1);var i=new L.MarkerCluster(this,b,g,a);e[b].addObject(i,this._map.project(i._cLatLng,b)),g.__parent=i,a.__parent=i;var j=i;for(d=b-1;d>h._zoom;d--)j=new L.MarkerCluster(this,d,j),e[d].addObject(j,this._map.project(g.getLatLng(),d));for(h._addChild(j),d=b;d>=0&&f[d].removeObject(g,this._map.project(g.getLatLng(),d));d--);return}f[b].addObject(a,c)}this._topClusterLevel._addChild(a),a.__parent=this._topClusterLevel},_mergeSplitClusters:function(){this._zoom<this._map._zoom&&this._currentShownBounds.contains(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,this._map._zoom)):this._zoom>this._map._zoom?(this._animationStart(),this._animationZoomOut(this._zoom,this._map._zoom)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this.getBounds();var a=this._map,b=a.getBounds(),c=b._southWest,d=b._northEast,e=L.Browser.mobile?0:Math.abs(c.lat-d.lat),f=L.Browser.mobile?0:Math.abs(c.lng-d.lng);return new L.LatLngBounds(new L.LatLng(c.lat-e,c.lng-f,!0),new L.LatLng(d.lat+e,d.lng+f,!0))},_animationAddLayerNonAnimated:function(a,b){if(b===a)this._featureGroup.addLayer(a);else if(2===b._childCount){b._addToMap();var c=b.getAllChildMarkers();this._featureGroup.removeLayer(c[0]),this._featureGroup.removeLayer(c[1])}else b._updateIcon()}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(a,b){var c,d=this,e=this._getExpandedVisibleBounds(),f=this._featureGroup;this._topClusterLevel._recursively(e,a,0,function(d){var g,h=d._latlng,i=d._markers;for(e.contains(h)||(h=null),d._isSingleParent()&&a+1===b?(f.removeLayer(d),d._recursivelyAddChildrenToMap(null,b,e)):(d.setOpacity(0),d._recursivelyAddChildrenToMap(h,b,e)),c=i.length-1;c>=0;c--)g=i[c],e.contains(g._latlng)||f.removeLayer(g)}),this._forceLayout(),d._topClusterLevel._recursivelyBecomeVisible(e,b),f.eachLayer(function(a){a instanceof L.MarkerCluster||!a._icon||a.setOpacity(1)}),d._topClusterLevel._recursively(e,a,b,function(a){a._recursivelyRestoreChildPositions(b)}),setTimeout(function(){d._topClusterLevel._recursively(e,a,0,function(a){f.removeLayer(a),a.setOpacity(1)}),d._animationEnd()},200)},_animationZoomOut:function(a,b){this._animationZoomOutSingle(this._topClusterLevel,a-1,b),this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(a,b,c){var d=this._getExpandedVisibleBounds();a._recursivelyAnimateChildrenInAndAddSelfToMap(d,b+1,c);var e=this;this._forceLayout(),a._recursivelyBecomeVisible(d,c),setTimeout(function(){if(1===a._childCount){var f=a._markers[0];f.setLatLng(f.getLatLng()),f.setOpacity(1)}else a._recursively(d,c,0,function(a){a._recursivelyRemoveChildrenFromMap(d,b+1)});e._animationEnd()},200)},_animationAddLayer:function(a,b){var c=this,d=this._featureGroup;d.addLayer(a),b!==a&&(b._childCount>2?(b._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(b.getLatLng())),a.setOpacity(0),setTimeout(function(){d.removeLayer(a),a.setOpacity(1),c._animationEnd()},200)):(this._forceLayout(),c._animationStart(),c._animationZoomOutSingle(b,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(b.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(a,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds())},_animationZoomOut:function(a,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,b){this._animationAddLayerNonAnimated(a,b)}}),L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)},L.MarkerCluster=L.Marker.extend({initialize:function(a,b,c,d){L.Marker.prototype.initialize.call(this,c?c._cLatLng||c.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=a,this._zoom=b,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._bounds=new L.LatLngBounds,c&&this._addChild(c),d&&this._addChild(d)},getAllChildMarkers:function(a){a=a||[];for(var b=this._childClusters.length-1;b>=0;b--)this._childClusters[b].getAllChildMarkers(a);for(var c=this._markers.length-1;c>=0;c--)a.push(this._markers[c]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var a,b=this._childClusters.slice(),c=this._group._map,d=c.getBoundsZoom(this._bounds),e=this._zoom+1;b.length>0&&d>e;){e++;var f=[];for(a=0;a<b.length;a++)f=f.concat(b[a]._childClusters);b=f}d>e?this._group._map.setView(this._latlng,e):this._group._map.fitBounds(this._bounds)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,b){this._iconNeedsUpdate=!0,this._expandBounds(a),a instanceof L.MarkerCluster?(b||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(b||this._markers.push(a),this._childCount++),this.__parent&&this.__parent._addChild(a,!0)},_expandBounds:function(a){var b,c=a._wLatLng||a._latlng;a instanceof L.MarkerCluster?(this._bounds.extend(a._bounds),b=a._childCount):(this._bounds.extend(c),b=1),this._cLatLng||(this._cLatLng=a._cLatLng||c);var d=this._childCount+b;this._wLatLng?(this._wLatLng.lat=(c.lat*b+this._wLatLng.lat*this._childCount)/d,this._wLatLng.lng=(c.lng*b+this._wLatLng.lng*this._childCount)/d):this._latlng=this._wLatLng=new L.LatLng(c.lat,c.lng)},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,b,c){this._recursively(a,0,c-1,function(a){var c,d,e=a._markers;for(c=e.length-1;c>=0;c--)d=e[c],d._icon&&(d._setPos(b),d.setOpacity(0))},function(a){var c,d,e=a._childClusters;for(c=e.length-1;c>=0;c--)d=e[c],d._icon&&(d._setPos(b),d.setOpacity(0))})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,b,c){this._recursively(a,c,0,function(d){d._recursivelyAnimateChildrenIn(a,d._group._map.latLngToLayerPoint(d.getLatLng()).round(),b),d._isSingleParent()&&b-1===c?(d.setOpacity(1),d._recursivelyRemoveChildrenFromMap(a,b)):d.setOpacity(0),d._addToMap()})},_recursivelyBecomeVisible:function(a,b){this._recursively(a,0,b,null,function(a){a.setOpacity(1)})},_recursivelyAddChildrenToMap:function(a,b,c){this._recursively(c,-1,b,function(d){if(b!==d._zoom)for(var e=d._markers.length-1;e>=0;e--){var f=d._markers[e];c.contains(f._latlng)&&(a&&(f._backupLatlng=f.getLatLng(),f.setLatLng(a),f.setOpacity&&f.setOpacity(0)),d._group._featureGroup.addLayer(f))}},function(b){b._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var b=this._markers.length-1;b>=0;b--){var c=this._markers[b];c._backupLatlng&&(c.setLatLng(c._backupLatlng),delete c._backupLatlng)}if(a-1===this._zoom)for(var d=this._childClusters.length-1;d>=0;d--)this._childClusters[d]._restorePosition();else for(var e=this._childClusters.length-1;e>=0;e--)this._childClusters[e]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,b,c){var d,e;this._recursively(a,-1,b-1,function(a){for(e=a._markers.length-1;e>=0;e--)d=a._markers[e],c&&c.contains(d._latlng)||(a._group._featureGroup.removeLayer(d),d.setOpacity&&d.setOpacity(1))},function(a){for(e=a._childClusters.length-1;e>=0;e--)d=a._childClusters[e],c&&c.contains(d._latlng)||(a._group._featureGroup.removeLayer(d),d.setOpacity&&d.setOpacity(1))})},_recursively:function(a,b,c,d,e){var f,g,h=this._childClusters,i=this._zoom;if(b>i)for(f=h.length-1;f>=0;f--)g=h[f],a.intersects(g._bounds)&&g._recursively(a,b,c,d,e);else if(d&&d(this),e&&this._zoom===c&&e(this),c>i)for(f=h.length-1;f>=0;f--)g=h[f],a.intersects(g._bounds)&&g._recursively(a,b,c,d,e)},_recalculateBounds:function(){var a,b=this._markers,c=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,a=b.length-1;a>=0;a--)this._expandBounds(b[a]);for(a=c.length-1;a>=0;a--)this._expandBounds(c[a])},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.DistanceGrid=function(a){this._cellSize=a,this._sqCellSize=a*a,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(a,b){var c=this._getCoord(b.x),d=this._getCoord(b.y),e=this._grid,f=e[d]=e[d]||{},g=f[c]=f[c]||[],h=L.Util.stamp(a);this._objectPoint[h]=b,g.push(a)},updateObject:function(a,b){this.removeObject(a),this.addObject(a,b)},removeObject:function(a,b){var c,d,e=this._getCoord(b.x),f=this._getCoord(b.y),g=this._grid,h=g[f]=g[f]||{},i=h[e]=h[e]||[];for(delete this._objectPoint[L.Util.stamp(a)],c=0,d=i.length;d>c;c++)if(i[c]===a)return i.splice(c,1),1===d&&delete h[e],!0},eachObject:function(a,b){var c,d,e,f,g,h,i,j=this._grid;for(c in j){g=j[c];for(d in g)for(h=g[d],e=0,f=h.length;f>e;e++)i=a.call(b,h[e]),i&&(e--,f--)}},getNearObject:function(a){var b,c,d,e,f,g,h,i,j=this._getCoord(a.x),k=this._getCoord(a.y),l=this._objectPoint,m=this._sqCellSize,n=null;for(b=k-1;k+1>=b;b++)if(e=this._grid[b])for(c=j-1;j+1>=c;c++)if(f=e[c])for(d=0,g=f.length;g>d;d++)h=f[d],i=this._sqDist(l[L.Util.stamp(h)],a),m>i&&(m=i,n=h);return n},_getCoord:function(a){return Math.floor(a/this._cellSize)},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d}},function(){L.QuickHull={getDistant:function(a,b){var c=b[1].lat-b[0].lat,d=b[0].lng-b[1].lng;return d*(a.lat-b[0].lat)+c*(a.lng-b[0].lng)},findMostDistantPointFromBaseLine:function(a,b){var c,d,e,f=0,g=null,h=[];for(c=b.length-1;c>=0;c--)d=b[c],e=this.getDistant(d,a),e>0&&(h.push(d),e>f&&(f=e,g=d));return{maxPoint:g,newPoints:h}},buildConvexHull:function(a,b){var c=[],d=this.findMostDistantPointFromBaseLine(a,b);return d.maxPoint?(c=c.concat(this.buildConvexHull([a[0],d.maxPoint],d.newPoints)),c=c.concat(this.buildConvexHull([d.maxPoint,a[1]],d.newPoints))):[a[0]]},getConvexHull:function(a){var b,c=!1,d=!1,e=null,f=null;for(b=a.length-1;b>=0;b--){var g=a[b];(c===!1||g.lat>c)&&(e=g,c=g.lat),(d===!1||g.lat<d)&&(f=g,d=g.lat)}var h=[].concat(this.buildConvexHull([f,e],a),this.buildConvexHull([e,f],a));return h}}}(),L.MarkerCluster.include({getConvexHull:function(){var a,b,c=this.getAllChildMarkers(),d=[];for(b=c.length-1;b>=0;b--)a=c[b].getLatLng(),d.push(a);return L.QuickHull.getConvexHull(d)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var a,b=this.getAllChildMarkers(),c=this._group,d=c._map,e=d.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,b.length>=this._circleSpiralSwitchover?a=this._generatePointsSpiral(b.length,e):(e.y+=10,a=this._generatePointsCircle(b.length,e)),this._animationSpiderfy(b,a)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,b){var c,d,e=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a),f=e/this._2PI,g=this._2PI/a,h=[];for(h.length=a,c=a-1;c>=0;c--)d=this._circleStartAngle+c*g,h[c]=new L.Point(b.x+f*Math.cos(d),b.y+f*Math.sin(d))._round();return h},_generatePointsSpiral:function(a,b){var c,d=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,e=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,f=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,g=0,h=[];for(h.length=a,c=a-1;c>=0;c--)g+=e/d+5e-4*c,h[c]=new L.Point(b.x+d*Math.cos(g),b.y+d*Math.sin(g))._round(),d+=this._2PI*f/g;return h},_noanimationUnspiderfy:function(){var a,b,c=this._group,d=c._map,e=c._featureGroup,f=this.getAllChildMarkers();for(this.setOpacity(1),b=f.length-1;b>=0;b--)a=f[b],e.removeLayer(a),a._preSpiderfyLatlng&&(a.setLatLng(a._preSpiderfyLatlng),delete a._preSpiderfyLatlng),a.setZIndexOffset&&a.setZIndexOffset(0),a._spiderLeg&&(d.removeLayer(a._spiderLeg),delete a._spiderLeg);c._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:function(){return b.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate")>-1}(),_animationSpiderfy:function(a,c){var d,e,f,g,h=this,i=this._group,j=i._map,k=i._featureGroup,l=j.latLngToLayerPoint(this._latlng);for(d=a.length-1;d>=0;d--)e=a[d],e.setOpacity?(e.setZIndexOffset(1e6),e.setOpacity(0),k.addLayer(e),e._setPos(l)):k.addLayer(e);i._forceLayout(),i._animationStart();var m=L.Path.SVG?0:.3,n=L.Path.SVG_NS;for(d=a.length-1;d>=0;d--)if(g=j.layerPointToLatLng(c[d]),e=a[d],e._preSpiderfyLatlng=e._latlng,e.setLatLng(g),e.setOpacity&&e.setOpacity(1),f=new L.Polyline([h._latlng,g],{weight:1.5,color:"#222",opacity:m}),j.addLayer(f),e._spiderLeg=f,L.Path.SVG&&this.SVG_ANIMATION){var o=f._path.getTotalLength();f._path.setAttribute("stroke-dasharray",o+","+o);var p=b.createElementNS(n,"animate");p.setAttribute("attributeName","stroke-dashoffset"),p.setAttribute("begin","indefinite"),p.setAttribute("from",o),p.setAttribute("to",0),p.setAttribute("dur",.25),f._path.appendChild(p),p.beginElement(),p=b.createElementNS(n,"animate"),p.setAttribute("attributeName","stroke-opacity"),p.setAttribute("attributeName","stroke-opacity"),p.setAttribute("begin","indefinite"),p.setAttribute("from",0),p.setAttribute("to",.5),p.setAttribute("dur",.25),f._path.appendChild(p),p.beginElement()}if(h.setOpacity(.3),L.Path.SVG)for(this._group._forceLayout(),d=a.length-1;d>=0;d--)e=a[d]._spiderLeg,e.options.opacity=.5,e._path.setAttribute("stroke-opacity",.5);setTimeout(function(){i._animationEnd(),i.fire("spiderfied")},200)},_animationUnspiderfy:function(a){var b,c,d,e=this._group,f=e._map,g=e._featureGroup,h=a?f._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):f.latLngToLayerPoint(this._latlng),i=this.getAllChildMarkers(),j=L.Path.SVG&&this.SVG_ANIMATION;for(e._animationStart(),this.setOpacity(1),c=i.length-1;c>=0;c--)b=i[c],b._preSpiderfyLatlng&&(b.setLatLng(b._preSpiderfyLatlng),delete b._preSpiderfyLatlng,b.setOpacity?(b._setPos(h),b.setOpacity(0)):g.removeLayer(b),j&&(d=b._spiderLeg._path.childNodes[0],d.setAttribute("to",d.getAttribute("from")),d.setAttribute("from",0),d.beginElement(),d=b._spiderLeg._path.childNodes[1],d.setAttribute("from",.5),d.setAttribute("to",0),d.setAttribute("stroke-opacity",0),d.beginElement(),b._spiderLeg._path.setAttribute("stroke-opacity",0)));setTimeout(function(){var a=0;for(c=i.length-1;c>=0;c--)b=i[c],b._spiderLeg&&a++;for(c=i.length-1;c>=0;c--)b=i[c],b._spiderLeg&&(b.setOpacity&&(b.setOpacity(1),b.setZIndexOffset(0)),a>1&&g.removeLayer(b),f.removeLayer(b._spiderLeg),delete b._spiderLeg);e._animationEnd()},200)}}:{_animationSpiderfy:function(a,b){var c,d,e,f,g=this._group,h=g._map,i=g._featureGroup;for(c=a.length-1;c>=0;c--)f=h.layerPointToLatLng(b[c]),d=a[c],d._preSpiderfyLatlng=d._latlng,d.setLatLng(f),d.setZIndexOffset&&d.setZIndexOffset(1e6),i.addLayer(d),e=new L.Polyline([this._latlng,f],{weight:1.5,color:"#222"}),h.addLayer(e),d._spiderLeg=e;this.setOpacity(.3),g.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Path.SVG&&!L.Browser.touch&&this._map._initPathRoot()},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.setOpacity(1),a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}})}(window,document),!function(){"use strict";function a(b){return this instanceof a?(this._canvas=b="string"==typeof b?document.getElementById(b):b,this._ctx=b.getContext("2d"),this._width=b.width,this._height=b.height,this._max=1,void this.clear()):new a(b)}a.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(a){return this._data=a,this},max:function(a){return this._max=a,this},add:function(a){return this._data.push(a),this},clear:function(){return this._data=[],this},radius:function(a,b){b=b||15;var c=this._circle=document.createElement("canvas"),d=c.getContext("2d"),e=this._r=a+b;return c.width=c.height=2*e,d.shadowOffsetX=d.shadowOffsetY=200,d.shadowBlur=b,d.shadowColor="black",d.beginPath(),d.arc(e-200,e-200,a,0,2*Math.PI,!0),d.closePath(),d.fill(),this},gradient:function(a){var b=document.createElement("canvas"),c=b.getContext("2d"),d=c.createLinearGradient(0,0,0,256);b.width=1,b.height=256;for(var e in a)d.addColorStop(e,a[e]);return c.fillStyle=d,c.fillRect(0,0,1,256),this._grad=c.getImageData(0,0,1,256).data,this},draw:function(a){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var b=this._ctx;b.clearRect(0,0,this._width,this._height);for(var c,d=0,e=this._data.length;e>d;d++)c=this._data[d],b.globalAlpha=Math.max(c[2]/this._max,a||.05),b.drawImage(this._circle,c[0]-this._r,c[1]-this._r);var f=b.getImageData(0,0,this._width,this._height);return this._colorize(f.data,this._grad),b.putImageData(f,0,0),this},_colorize:function(a,b){for(var c,d=3,e=a.length;e>d;d+=4)c=4*a[d],c&&(a[d-3]=b[c],a[d-2]=b[c+1],a[d-1]=b[c+2])}},window.simpleheat=a}(),L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(a,b){this._latlngs=a,L.setOptions(this,b)},setLatLngs:function(a){return this._latlngs=a,this.redraw()},addLatLng:function(a){return this._latlngs.push(a),this.redraw()},setOptions:function(a){return L.setOptions(this,a),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(a){this._map=a,this._canvas||this._initCanvas(),a._panes.overlayPane.appendChild(this._canvas),a.on("moveend",this._reset,this),a.options.zoomAnimation&&L.Browser.any3d&&a.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._canvas),a.off("moveend",this._reset,this),a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},_initCanvas:function(){var a=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),b=this._map.getSize();a.width=b.x,a.height=b.y;var c=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(a,"leaflet-zoom-"+(c?"animated":"hide")),this._heat=simpleheat(a),this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur),this.options.gradient&&this._heat.gradient(this.options.gradient),this.options.max&&this._heat.max(this.options.max)},_reset:function(){var a=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,a);var b=this._map.getSize();this._heat._width!==b.x&&(this._canvas.width=this._heat._width=b.x),this._heat._height!==b.y&&(this._canvas.height=this._heat._height=b.y),this._redraw()},_redraw:function(){var a,b,c,d,e,f,g,h,i,j=[],k=this._heat._r,l=this._map.getSize(),m=new L.LatLngBounds(this._map.containerPointToLatLng(L.point([-k,-k])),this._map.containerPointToLatLng(l.add([k,k]))),n=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom,o=1/Math.pow(2,Math.max(0,Math.min(n-this._map.getZoom(),12))),p=k/2,q=[],r=this._map._getMapPanePos(),s=r.x%p,t=r.y%p;for(a=0,b=this._latlngs.length;b>a;a++)if(m.contains(this._latlngs[a])){c=this._map.latLngToContainerPoint(this._latlngs[a]),e=Math.floor((c.x-s)/p)+2,f=Math.floor((c.y-t)/p)+2;var u=void 0!==this._latlngs[a].alt?this._latlngs[a].alt:void 0!==this._latlngs[a][2]?+this._latlngs[a][2]:1;i=u*o,q[f]=q[f]||[],d=q[f][e],d?(d[0]=(d[0]*d[2]+c.x*i)/(d[2]+i),d[1]=(d[1]*d[2]+c.y*i)/(d[2]+i),d[2]+=i):q[f][e]=[c.x,c.y,i]}for(a=0,b=q.length;b>a;a++)if(q[a])for(g=0,h=q[a].length;h>g;g++)d=q[a][g],d&&j.push([Math.round(d[0]),Math.round(d[1]),Math.min(d[2],1)]);this._heat.data(j).draw(this.options.minOpacity),this._frame=null},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._getCenterOffset(a.center)._multiplyBy(-b).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,c,b):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(c)+" scale("+b+")"
}}),L.heatLayer=function(a,b){return new L.HeatLayer(a,b)},function(a,b,c){L.drawVersion="0.2.4-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(a,b){this._map=a,this._container=a._container,this._overlayPane=a._panes.overlayPane,this._popupPane=a._panes.popupPane,b&&b.shapeOptions&&(b.shapeOptions=L.Util.extend({},this.options.shapeOptions,b.shapeOptions)),L.setOptions(this,b)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var a=this._map;a&&(L.DomUtil.disableTextSelection(),a.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(a){L.setOptions(this,a)},_fireCreatedEvent:function(a){this._map.fire("draw:created",{layer:a,layerType:this.type})},_cancelDrawing:function(a){27===a.keyCode&&this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,showLength:!0,zIndexOffset:2e3},initialize:function(a,b){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,b&&b.drawError&&(b.drawError=L.Util.extend({},this.options.drawError,b.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,a,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mousedown",this._onMouseDown,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this).on("mouseup",this._onMouseUp,this).on("zoomlevelschange",this._onZoomChange,this).on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseup",this._onMouseUp,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mousemove",this._onMouseMove,this).off("mouseup",this._onMouseUp,this).off("zoomlevelschange",this._onZoomChange,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var a=this._markers.pop(),b=this._poly,c=this._poly.spliceLatLngs(b.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(a),b.getLatLngs().length<2&&this._map.removeLayer(b),this._vertexChanged(c,!1)}},addVertex:function(a){var b=this._markers.length;return b>0&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(a)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(a)),this._poly.addLatLng(a),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),void this._vertexChanged(a,!0))},completeShape:function(){this._markers.length<=1||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var a=this._poly.newLatLngIntersects(this._poly.getLatLngs()[0],!0);return!this.options.allowIntersection&&a||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomChange:function(){this._updateGuide()},_onMouseMove:function(a){var b=a.layerPoint,c=a.latlng;this._currentLatLng=c,this._updateTooltip(c),this._updateGuide(b),this._mouseMarker.setLatLng(c),L.DomEvent.preventDefault(a.originalEvent)},_onMouseDown:function(a){var b=a.originalEvent;this._mouseDownOrigin=L.point(b.clientX,b.clientY)},_onMouseUp:function(b){if(this._mouseDownOrigin){var c=L.point(b.originalEvent.clientX,b.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(c)<9*(a.devicePixelRatio||1)&&this.addVertex(b.latlng)}this._mouseDownOrigin=null},_onTouch:function(a){L.Browser.touch&&(this._onMouseMove(a),this._onMouseDown(a),this._onMouseUp(a))},_vertexChanged:function(a,b){this._updateFinishHandler(),this._updateRunningMeasure(a,b),this._clearGuides(),this._updateTooltip()},_updateFinishHandler:function(){var a=this._markers.length;a>1&&this._markers[a-1].on("click",this._finishShape,this),a>2&&this._markers[a-2].off("click",this._finishShape,this)},_createMarker:function(a){var b=new L.Marker(a,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(b),b},_updateGuide:function(a){var b=this._markers.length;b>0&&(a=a||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[b-1].getLatLng()),a))},_updateTooltip:function(a){var b=this._getTooltipText();a&&this._tooltip.updatePosition(a),this._errorShown||this._tooltip.updateContent(b)},_drawGuide:function(a,b){var c,d,e,f=Math.floor(Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))),g=this.options.guidelineDistance,h=this.options.maxGuideLineLength,i=f>h?f-h:g;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));f>i;i+=this.options.guidelineDistance)c=i/f,d={x:Math.floor(a.x*(1-c)+c*b.x),y:Math.floor(a.y*(1-c)+c*b.y)},e=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),e.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(e,d)},_updateGuideColor:function(a){if(this._guidesContainer)for(var b=0,c=this._guidesContainer.childNodes.length;c>b;b++)this._guidesContainer.childNodes[b].style.backgroundColor=a},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var a,b,c=this.options.showLength;return 0===this._markers.length?a={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(b=c?this._getMeasurementString():"",a=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:b}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:b}),a},_updateRunningMeasure:function(a,b){var c,d,e=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(c=e-(b?2:1),d=a.distanceTo(this._markers[c].getLatLng()),this._measurementRunningTotal+=d*(b?1:-1))},_getMeasurementString:function(){var a,b=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng();return a=this._measurementRunningTotal+b.distanceTo(c),L.GeometryUtil.readableDistance(a,this.options.metric)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var a=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,a)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(a,b){L.Draw.Polyline.prototype.initialize.call(this,a,b),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var a=this._markers.length;1===a&&this._markers[0].on("click",this._finishShape,this),a>2&&(this._markers[a-1].on("dblclick",this._finishShape,this),a>3&&this._markers[a-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var a,b;return 0===this._markers.length?a=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?a=L.drawLocal.draw.handlers.polygon.tooltip.cont:(a=L.drawLocal.draw.handlers.polygon.tooltip.end,b=this._getMeasurementString()),{text:a,subtext:b}},_getMeasurementString:function(){var a=this._area;return a?L.GeometryUtil.readableArea(a,this.options.metric):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(a,b){var c;!this.options.allowIntersection&&this.options.showArea&&(c=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(c)),L.Draw.Polyline.prototype._vertexChanged.call(this,a,b)},_cleanUpShape:function(){var a=this._markers.length;a>0&&(this._markers[0].off("click",this._finishShape,this),a>2&&this._markers[a-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(a,b){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,a,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(b,"mouseup",this._onMouseUp,this),L.DomEvent.off(b,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(a){this._isDrawing=!0,this._startLatLng=a.latlng,L.DomEvent.on(b,"mouseup",this._onMouseUp,this).on(b,"touchend",this._onMouseUp,this).preventDefault(a.originalEvent)},_onMouseMove:function(a){var b=a.latlng;this._tooltip.updatePosition(b),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(b))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(a,b){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,a,b)},_drawShape:function(a){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,a)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,a),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var a=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,a)},_getTooltipText:function(){var a,b,c,d=L.Draw.SimpleShape.prototype._getTooltipText.call(this),e=this._shape;return e&&(a=this._shape.getLatLngs(),b=L.GeometryUtil.geodesicArea(a),c=L.GeometryUtil.readableArea(b,this.options.metric)),{text:d.text,subtext:c}}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0},initialize:function(a,b){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,a,b)},_drawShape:function(a){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(a)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(a),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var a=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,a)},_onMouseMove:function(a){var b,c=a.latlng,d=this.options.showRadius,e=this.options.metric;this._tooltip.updatePosition(c),this._isDrawing&&(this._drawShape(c),b=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:d?L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(b,e):""}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(a,b){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,a,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this),this._map.off("click",this._onTouch,this))},_onMouseMove:function(a){var b=a.latlng;this._tooltip.updatePosition(b),this._mouseMarker.setLatLng(b),this._marker?(b=this._mouseMarker.getLatLng(),this._marker.setLatLng(b)):(this._marker=new L.Marker(b,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(a){this._onMouseMove(a),this._onClick()},_fireCreatedEvent:function(){var a=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,a)}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(a,b){this._marker=a,L.setOptions(this,b)},addHooks:function(){var a=this._marker;a.dragging.enable(),a.on("dragend",this._onDragEnd,a),this._toggleMarkerHighlight()},removeHooks:function(){var a=this._marker;a.dragging.disable(),a.off("dragend",this._onDragEnd,a),this._toggleMarkerHighlight()},_onDragEnd:function(a){var b=a.target;b.edited=!0},_toggleMarkerHighlight:function(){if(this._icon){var a=this._icon;a.style.display="none",L.DomUtil.hasClass(a,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(a,"leaflet-edit-marker-selected"),this._offsetMarker(a,-4)):(L.DomUtil.addClass(a,"leaflet-edit-marker-selected"),this._offsetMarker(a,4)),a.style.display=""}},_offsetMarker:function(a,b){var c=parseInt(a.style.marginTop,10)-b,d=parseInt(a.style.marginLeft,10)-b;a.style.marginTop=c+"px",a.style.marginLeft=d+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"})},initialize:function(a,b){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=a,L.setOptions(this,b)},addHooks:function(){var a=this._poly;a instanceof L.Polygon||(a.options.editing.fill=!1),a.setStyle(a.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var a=this._poly;a.setStyle(a.options.original),a._map&&(a._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var a,b,c,d,e=this._poly._latlngs;for(a=0,c=e.length;c>a;a++)d=this._createMarker(e[a],a),d.on("click",this._onMarkerClick,this),this._markers.push(d);var f,g;for(a=0,b=c-1;c>a;b=a++)(0!==a||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[b],g=this._markers[a],this._createMiddleMarker(f,g),this._updatePrevNext(f,g))},_createMarker:function(a,b){var c=new L.Marker.Touch(a,{draggable:!0,icon:this.options.icon});return c._origLatLng=a,c._index=b,c.on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this),this._markerGroup.addLayer(c),c},_removeMarker:function(a){var b=a._index;this._markerGroup.removeLayer(a),this._markers.splice(b,1),this._poly.spliceLatLngs(b,1),this._updateIndexes(b,-1),a.off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit")},_onMarkerDrag:function(a){var b=a.target;L.extend(b._origLatLng,b._latlng),b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b)),b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,b._next)),this._poly.redraw()},_onMarkerClick:function(a){var b=L.Polygon&&this._poly instanceof L.Polygon?4:3,c=a.target;this._poly._latlngs.length<b||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(a){var b=this._map.mouseEventToLayerPoint(a.originalEvent.touches[0]),c=this._map.layerPointToLatLng(b),d=a.target;L.extend(d._origLatLng,c),d._middleLeft&&d._middleLeft.setLatLng(this._getMiddleLatLng(d._prev,d)),d._middleRight&&d._middleRight.setLatLng(this._getMiddleLatLng(d,d._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(a,b){this._markerGroup.eachLayer(function(c){c._index>a&&(c._index+=b)})},_createMiddleMarker:function(a,b){var c,d,e,f=this._getMiddleLatLng(a,b),g=this._createMarker(f);g.setOpacity(.6),a._middleRight=b._middleLeft=g,d=function(){var d=b._index;g._index=d,g.off("click",c,this).on("click",this._onMarkerClick,this),f.lat=g.getLatLng().lat,f.lng=g.getLatLng().lng,this._poly.spliceLatLngs(d,0,f),this._markers.splice(d,0,g),g.setOpacity(1),this._updateIndexes(d,1),b._index++,this._updatePrevNext(a,g),this._updatePrevNext(g,b),this._poly.fire("editstart")},e=function(){g.off("dragstart",d,this),g.off("dragend",e,this),g.off("touchmove",d,this),this._createMiddleMarker(a,g),this._createMiddleMarker(g,b)},c=function(){d.call(this),e.call(this),this._fireEdit()},g.on("click",c,this).on("dragstart",d,this).on("dragend",e,this).on("touchmove",d,this),this._markerGroup.addLayer(g)},_updatePrevNext:function(a,b){a&&(a._next=b),b&&(b._prev=a)},_getMiddleLatLng:function(a,b){var c=this._poly._map,d=c.project(a.getLatLng()),e=c.project(b.getLatLng());return c.unproject(d._add(e)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(a,b){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=a,L.Util.setOptions(this,b)},addHooks:function(){var a=this._shape;this._shape._map&&(this._map=this._shape._map,a.setStyle(a.options.editing),a._map&&(this._map=a._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var a=this._shape;if(a.setStyle(a.options.original),a._map){this._unbindMarker(this._moveMarker);for(var b=0,c=this._resizeMarkers.length;c>b;b++)this._unbindMarker(this._resizeMarkers[b]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(a,b){var c=new L.Marker.Touch(a,{draggable:!0,icon:b,zIndexOffset:10});return this._bindMarker(c),this._markerGroup.addLayer(c),c},_bindMarker:function(a){a.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this)},_unbindMarker:function(a){a.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this)},_onMarkerDragStart:function(a){var b=a.target;b.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(a){var b=a.target,c=b.getLatLng();b===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw()},_onMarkerDragEnd:function(a){var b=a.target;b.setOpacity(1),this._fireEdit()},_onTouchStart:function(a){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,a),"function"==typeof this._getCorners){var b=this._getCorners(),c=a.target,d=c._cornerIndex;c.setOpacity(0),this._oppositeCorner=b[(d+2)%4],this._toggleCornerMarkers(0,d)}this._shape.fire("editstart")},_onTouchMove:function(a){var b=this._map.mouseEventToLayerPoint(a.originalEvent.touches[0]),c=this._map.layerPointToLatLng(b),d=a.target;return d===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),d===this._moveMarker?this._moveMarker.setLatLng(this._shape.getLatLng()):this.updateMarkers(),!1},_onTouchEnd:function(a){var b=a.target;b.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var a=this._shape.getBounds(),b=a.getCenter();this._moveMarker=this._createMarker(b,this.options.moveIcon)},_createResizeMarker:function(){var a=this._getCorners();this._resizeMarkers=[];for(var b=0,c=a.length;c>b;b++)this._resizeMarkers.push(this._createMarker(a[b],this.options.resizeIcon)),this._resizeMarkers[b]._cornerIndex=b},_onMarkerDragStart:function(a){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,a);var b=this._getCorners(),c=a.target,d=c._cornerIndex;this._oppositeCorner=b[(d+2)%4],this._toggleCornerMarkers(0,d)},_onMarkerDragEnd:function(a){var b,c,d=a.target;d===this._moveMarker&&(b=this._shape.getBounds(),c=b.getCenter(),d.setLatLng(c)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,a)},_move:function(a){for(var b,c=this._shape.getLatLngs(),d=this._shape.getBounds(),e=d.getCenter(),f=[],g=0,h=c.length;h>g;g++)b=[c[g].lat-e.lat,c[g].lng-e.lng],f.push([a.lat+b[0],a.lng+b[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers()},_resize:function(a){var b;if(this._shape.options.aspectRatio!==c){b=this._shape.getBounds();var d=this._map.project(this._oppositeCorner).round(),e=this._map.project(a).round(),f=Math.abs(d.y-e.y)*this._shape.options.aspectRatio;e.x=d.x<e.x?d.x+f:d.x-f,a=this._map.unproject(e)}this._shape.setBounds(L.latLngBounds(a,this._oppositeCorner)),b=this._shape.getBounds(),this._moveMarker.setLatLng(b.getCenter())},_getCorners:function(){var a=this._shape.getBounds(),b=a.getNorthWest(),c=a.getNorthEast(),d=a.getSouthEast(),e=a.getSouthWest();return[b,c,d,e]},_toggleCornerMarkers:function(a){for(var b=0,c=this._resizeMarkers.length;c>b;b++)this._resizeMarkers[b].setOpacity(a)},_repositionCornerMarkers:function(){for(var a=this._getCorners(),b=0,c=this._resizeMarkers.length;c>b;b++)this._resizeMarkers[b].setLatLng(a[b])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var a=this._shape.getLatLng();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var a=this._shape.getLatLng(),b=this._getResizeMarkerPoint(a);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(b,this.options.resizeIcon))},_getResizeMarkerPoint:function(a){var b=this._shape._radius*Math.cos(Math.PI/4),c=this._map.project(a);return this._map.unproject([c.x+b,c.y-b])},_move:function(a){var b=this._getResizeMarkerPoint(a);this._resizeMarkers[0].setLatLng(b),this._shape.setLatLng(a)},_resize:function(a){var b=this._moveMarker.getLatLng(),c=b.distanceTo(a);this._shape.setRadius(c)}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this)},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart),L.DomEvent.off(this._container,"touchend",this._onTouchEnd),L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave),L.DomEvent.off(this._container,"touchmove",this._onTouchMove)},_touchEvent:function(a,b){if(a.touches.length){var c=this._map.mouseEventToContainerPoint(a.touches[0]),d=this._map.mouseEventToLayerPoint(a.touches[0]),e=this._map.layerPointToLatLng(d);this._map.fire(b,{latlng:e,layerPoint:d,containerPoint:c,pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,originalEvent:a})}},_onTouchStart:function(a){if(this._map._loaded){var b="touchstart";this._touchEvent(a,b)}},_onTouchEnd:function(a){if(this._map._loaded){var b="touchend";this._touchEvent(a,b)}},_onTouchCancel:function(a){if(this._map._loaded){var b="touchcancel";this._touchEvent(a,b)}},_onTouchLeave:function(a){if(this._map._loaded){var b="touchleave";this._touchEvent(a,b)}},_onTouchMove:function(a){if(this._map._loaded){var b="touchmove";this._touchEvent(a,b)}}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){if(this.options.clickable){var a=this._icon,b=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove","touchcancel"];L.DomUtil.addClass(a,"leaflet-clickable"),L.DomEvent.on(a,"click",this._onMouseClick,this),L.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var c=0;c<b.length;c++)L.DomEvent.on(a,b[c],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}}}),L.LatLngUtil={cloneLatLngs:function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(this.cloneLatLng(a[c]));
return b},cloneLatLng:function(a){return L.latLng(a.lat,a.lng)}},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var b,c,d=a.length,e=0,f=L.LatLng.DEG_TO_RAD;if(d>2){for(var g=0;d>g;g++)b=a[g],c=a[(g+1)%d],e+=(c.lng-b.lng)*f*(2+Math.sin(b.lat*f)+Math.sin(c.lat*f));e=6378137*e*6378137/2}return Math.abs(e)},readableArea:function(a,b){var c;return b?c=a>=1e4?(1e-4*a).toFixed(2)+" ha":a.toFixed(2)+" m&sup2;":(a/=.836127,c=a>=3097600?(a/3097600).toFixed(2)+" mi&sup2;":a>=4840?(a/4840).toFixed(2)+" acres":Math.ceil(a)+" yd&sup2;"),c},readableDistance:function(a,b){var c;return b?c=a>1e3?(a/1e3).toFixed(2)+" km":Math.ceil(a)+" m":(a*=1.09361,c=a>1760?(a/1760).toFixed(2)+" miles":Math.ceil(a)+" yd"),c}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(a,b,c,d){return this._checkCounterclockwise(a,c,d)!==this._checkCounterclockwise(b,c,d)&&this._checkCounterclockwise(a,b,c)!==this._checkCounterclockwise(a,b,d)},_checkCounterclockwise:function(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)}}),L.Polyline.include({intersects:function(){var a,b,c,d=this._originalPoints,e=d?d.length:0;if(this._tooFewPointsForIntersection())return!1;for(a=e-1;a>=3;a--)if(b=d[a-1],c=d[a],this._lineSegmentsIntersectsRange(b,c,a-2))return!0;return!1},newLatLngIntersects:function(a,b){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(a),b):!1},newPointIntersects:function(a,b){var c=this._originalPoints,d=c?c.length:0,e=c?c[d-1]:null,f=d-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(e,a,f,b?1:0)},_tooFewPointsForIntersection:function(a){var b=this._originalPoints,c=b?b.length:0;return c+=a||0,!this._originalPoints||3>=c},_lineSegmentsIntersectsRange:function(a,b,c,d){var e,f,g=this._originalPoints;d=d||0;for(var h=c;h>d;h--)if(e=g[h-1],f=g[h],L.LineUtil.segmentsIntersect(a,b,e,f))return!0;return!1}}),L.Polygon.include({intersects:function(){var a,b,c,d,e,f=this._originalPoints;return this._tooFewPointsForIntersection()?!1:(a=L.Polyline.prototype.intersects.call(this))?!0:(b=f.length,c=f[0],d=f[b-1],e=b-2,this._lineSegmentsIntersectsRange(d,c,e,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(a){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,a);var b;this._toolbars={},L.DrawToolbar&&this.options.draw&&(b=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=b,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(b=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=b,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(a){var b,c=L.DomUtil.create("div","leaflet-draw"),d=!1,e="leaflet-draw-toolbar-top";for(var f in this._toolbars)this._toolbars.hasOwnProperty(f)&&(b=this._toolbars[f].addToolbar(a),b&&(d||(L.DomUtil.hasClass(b,e)||L.DomUtil.addClass(b.childNodes[0],e),d=!0),c.appendChild(b)));return c},onRemove:function(){for(var a in this._toolbars)this._toolbars.hasOwnProperty(a)&&this._toolbars[a].removeToolbar()},setDrawingOptions:function(a){for(var b in this._toolbars)this._toolbars[b]instanceof L.DrawToolbar&&this._toolbars[b].setOptions(a)},_toolbarEnabled:function(a){var b=a.target;for(var c in this._toolbars)this._toolbars[c]!==b&&this._toolbars[c].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(a){L.setOptions(this,a),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(a){var b,c=L.DomUtil.create("div","leaflet-draw-section"),d=0,e=this._toolbarClass||"",f=this.getModeHandlers(a);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=a,b=0;b<f.length;b++)f[b].enabled&&this._initModeHandler(f[b].handler,this._toolbarContainer,d++,e,f[b].title);return d?(this._lastButtonIndex=--d,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c):void 0},removeToolbar:function(){for(var a in this._modes)this._modes.hasOwnProperty(a)&&(this._disposeButton(this._modes[a].button,this._modes[a].handler.enable,this._modes[a].handler),this._modes[a].handler.disable(),this._modes[a].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var b=0,c=this._actionButtons.length;c>b;b++)this._disposeButton(this._actionButtons[b].button,this._actionButtons[b].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(a,b,c,d,e){var f=a.type;this._modes[f]={},this._modes[f].handler=a,this._modes[f].button=this._createButton({type:f,title:e,className:d+"-"+f,container:b,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=c,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(a){var b=L.DomUtil.create("a",a.className||"",a.container);return b.href="#",a.text&&(b.innerHTML=a.text),a.title&&(b.title=a.title),L.DomEvent.on(b,"click",L.DomEvent.stopPropagation).on(b,"mousedown",L.DomEvent.stopPropagation).on(b,"dblclick",L.DomEvent.stopPropagation).on(b,"click",L.DomEvent.preventDefault).on(b,"click",a.callback,a.context),b},_disposeButton:function(a,b){L.DomEvent.off(a,"click",L.DomEvent.stopPropagation).off(a,"mousedown",L.DomEvent.stopPropagation).off(a,"dblclick",L.DomEvent.stopPropagation).off(a,"click",L.DomEvent.preventDefault).off(a,"click",b)},_handlerActivated:function(a){this.disable(),this._activeMode=this._modes[a.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(a){var b,c,d,e,f=this._actionsContainer,g=this.getActions(a),h=g.length;for(c=0,d=this._actionButtons.length;d>c;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var i=0;h>i;i++)"enabled"in g[i]&&!g[i].enabled||(b=L.DomUtil.create("li","",f),e=this._createButton({title:g[i].title,text:g[i].text,container:b,callback:g[i].callback,context:g[i].context}),this._actionButtons.push({button:e,callback:g[i].callback}))},_showActionsToolbar:function(){var a=this._activeMode.buttonIndex,b=this._lastButtonIndex,c=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=c+"px",0===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),a===b&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}}),L.Tooltip=L.Class.extend({initialize:function(a){this._map=a,this._popupPane=a._panes.popupPane,this._container=a.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1},dispose:function(){this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(a){return this._container?(a.subtext=a.subtext||"",0!==a.subtext.length||this._singleLineLabel?a.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(a.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+a.subtext+"</span><br />":"")+"<span>"+a.text+"</span>",this):this},updatePosition:function(a){var b=this._map.latLngToLayerPoint(a),c=this._container;return this._container&&(c.style.visibility="inherit",L.DomUtil.setPosition(c,b)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(a){for(var b in this.options)this.options.hasOwnProperty(b)&&a[b]&&(a[b]=L.extend({},this.options[b],a[b]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,a)},getModeHandlers:function(a){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(a,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(a,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(a,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(a,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(a,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(a){return[{enabled:a.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:a.completeShape,context:a},{enabled:a.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:a.deleteLastVertex,context:a},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(a){L.setOptions(this,a);for(var b in this._modes)this._modes.hasOwnProperty(b)&&a.hasOwnProperty(b)&&this._modes[b].handler.setOptions(a[b])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},featureGroup:null},initialize:function(a){a.edit&&("undefined"==typeof a.edit.selectedPathOptions&&(a.edit.selectedPathOptions=this.options.edit.selectedPathOptions),a.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,a.edit.selectedPathOptions)),a.remove&&(a.remove=L.extend({},this.options.remove,a.remove)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,a),this._selectedFeatureCount=0},getModeHandlers:function(a){var b=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(a,{featureGroup:b,selectedPathOptions:this.options.edit.selectedPathOptions}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(a,{featureGroup:b}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(a){var b=L.Toolbar.prototype.addToolbar.call(this,a);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),b},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode.handler.disable()},_checkDisabled:function(){var a,b=this.options.featureGroup,c=0!==b.getLayers().length;this.options.edit&&(a=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(a,"leaflet-disabled"):L.DomUtil.addClass(a,"leaflet-disabled"),a.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(a=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(a,"leaflet-disabled"):L.DomUtil.addClass(a,"leaflet-disabled"),a.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(a,b){if(L.Handler.prototype.initialize.call(this,a),L.setOptions(this,b),this._featureGroup=b.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:editstop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var a=this._map;a&&(a.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("click",this._editStyle,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this))},revertLayers:function(){this._featureGroup.eachLayer(function(a){this._revertLayer(a)},this)},save:function(){var a=new L.LayerGroup;this._featureGroup.eachLayer(function(b){b.edited&&(a.addLayer(b),b.edited=!1)}),this._map.fire("draw:edited",{layers:a})},_backupLayer:function(a){var b=L.Util.stamp(a);this._uneditedLayerProps[b]||(a instanceof L.Polyline||a instanceof L.Polygon||a instanceof L.Rectangle?this._uneditedLayerProps[b]={latlngs:L.LatLngUtil.cloneLatLngs(a.getLatLngs())}:a instanceof L.Circle?this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(a.getLatLng()),radius:a.getRadius()}:a instanceof L.Marker&&(this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(a.getLatLng())}))},_revertLayer:function(a){var b=L.Util.stamp(a);a.edited=!1,this._uneditedLayerProps.hasOwnProperty(b)&&(a instanceof L.Polyline||a instanceof L.Polygon||a instanceof L.Rectangle?a.setLatLngs(this._uneditedLayerProps[b].latlngs):a instanceof L.Circle?(a.setLatLng(this._uneditedLayerProps[b].latlng),a.setRadius(this._uneditedLayerProps[b].radius)):a instanceof L.Marker&&a.setLatLng(this._uneditedLayerProps[b].latlng),a.fire("revert-edited",{layer:a}))},_enableLayerEdit:function(a){var b,c=a.layer||a.target||a;this._backupLayer(c),this.options.selectedPathOptions&&(b=L.Util.extend({},this.options.selectedPathOptions),b.maintainColor&&(b.color=c.options.color,b.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=b),this.isMarker?(c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(a){var b=a.layer||a.target||a;b.edited=!1,b.editing.disable(),delete b.options.editing,delete b.options.original,this._selectedPathOptions&&(b instanceof L.Marker?this._toggleMarkerHighlight(b):(b.setStyle(b.options.previousOptions),delete b.options.previousOptions)),b instanceof L.Marker?(b.dragging.disable(),b.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this)):b.editing.disable()},_onMouseMove:function(a){this._tooltip.updatePosition(a.latlng)},_onTouchMove:function(a){var b=a.originalEvent.changedTouches[0],c=this._map.mouseEventToLayerPoint(b),d=this._map.layerPointToLatLng(c);a.target.setLatLng(d)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(a,b){if(L.Handler.prototype.initialize.call(this,a),L.Util.setOptions(this,b),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:deletestart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:deletestop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var a=this._map;a&&(a.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(a){this._deletableLayers.addLayer(a),a.fire("revert-deleted",{layer:a})},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(a){var b=a.layer||a.target||a;b.on("click",this._removeLayer,this)},_disableLayerDelete:function(a){var b=a.layer||a.target||a;b.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(b)},_removeLayer:function(a){var b=a.layer||a.target||a;this._deletableLayers.removeLayer(b),this._deletedLayers.addLayer(b),b.fire("deleted")},_onMouseMove:function(a){this._tooltip.updatePosition(a.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document),function(){L.labelVersion="0.2.2-dev",L.Label=L.Class.extend({includes:L.Mixin.Events,options:{className:"",clickable:!1,direction:"right",noHide:!1,offset:[12,-15],opacity:1,zoomAnimation:!0},initialize:function(a,b){L.setOptions(this,a),this._source=b,this._animated=L.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(a){this._map=a,this._pane=this._source instanceof L.Marker?a._panes.markerPane:a._panes.popupPane,this._container||this._initLayout(),this._pane.appendChild(this._container),this._initInteraction(),this._update(),this.setOpacity(this.options.opacity),a.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this),this._animated&&a.on("zoomanim",this._zoomAnimation,this),L.Browser.touch&&!this.options.noHide&&L.DomEvent.on(this._container,"click",this.close,this)},onRemove:function(a){this._pane.removeChild(this._container),a.off({zoomanim:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this),this._removeInteraction(),this._map=null},setLatLng:function(a){return this._latlng=L.latLng(a),this._map&&this._updatePosition(),this},setContent:function(a){return this._previousContent=this._content,this._content=a,this._updateContent(),this},close:function(){var a=this._map;a&&(L.Browser.touch&&!this.options.noHide&&L.DomEvent.off(this._container,"click",this.close),a.removeLayer(this))},updateZIndex:function(a){this._zIndex=a,this._container&&this._zIndex&&(this._container.style.zIndex=a)},setOpacity:function(a){this.options.opacity=a,this._container&&L.DomUtil.setOpacity(this._container,a)},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-label "+this.options.className+" leaflet-zoom-animated"),this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._container.style.visibility="")},_updateContent:function(){this._content&&this._map&&this._prevContent!==this._content&&"string"==typeof this._content&&(this._container.innerHTML=this._content,this._prevContent=this._content,this._labelWidth=this._container.offsetWidth)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},_setPosition:function(a){var b=this._map,c=this._container,d=b.latLngToContainerPoint(b.getCenter()),e=b.layerPointToContainerPoint(a),f=this.options.direction,g=this._labelWidth,h=L.point(this.options.offset);"right"===f||"auto"===f&&e.x<d.x?(L.DomUtil.addClass(c,"leaflet-label-right"),L.DomUtil.removeClass(c,"leaflet-label-left"),a=a.add(h)):(L.DomUtil.addClass(c,"leaflet-label-left"),L.DomUtil.removeClass(c,"leaflet-label-right"),a=a.add(L.point(-h.x-g,h.y))),L.DomUtil.setPosition(c,a)},_zoomAnimation:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPosition(b)},_onMoveEnd:function(){this._animated&&"auto"!==this.options.direction||this._updatePosition()},_onViewReset:function(a){a&&a.hard&&this._update()},_initInteraction:function(){if(this.options.clickable){var a=this._container,b=["dblclick","mousedown","mouseover","mouseout","contextmenu"];L.DomUtil.addClass(a,"leaflet-clickable"),L.DomEvent.on(a,"click",this._onMouseClick,this);for(var c=0;b.length>c;c++)L.DomEvent.on(a,b[c],this._fireMouseEvent,this)}},_removeInteraction:function(){if(this.options.clickable){var a=this._container,b=["dblclick","mousedown","mouseover","mouseout","contextmenu"];L.DomUtil.removeClass(a,"leaflet-clickable"),L.DomEvent.off(a,"click",this._onMouseClick,this);for(var c=0;b.length>c;c++)L.DomEvent.off(a,b[c],this._fireMouseEvent,this)}},_onMouseClick:function(a){this.hasEventListeners(a.type)&&L.DomEvent.stopPropagation(a),this.fire(a.type,{originalEvent:a})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a}),"contextmenu"===a.type&&this.hasEventListeners(a.type)&&L.DomEvent.preventDefault(a),"mousedown"!==a.type?L.DomEvent.stopPropagation(a):L.DomEvent.preventDefault(a)}}),L.BaseMarkerMethods={showLabel:function(){return this.label&&this._map&&(this.label.setLatLng(this._latlng),this._map.showLabel(this.label)),this},hideLabel:function(){return this.label&&this.label.close(),this},setLabelNoHide:function(a){this._labelNoHide!==a&&(this._labelNoHide=a,a?(this._removeLabelRevealHandlers(),this.showLabel()):(this._addLabelRevealHandlers(),this.hideLabel()))},bindLabel:function(a,b){var c=this.options.icon?this.options.icon.options.labelAnchor:this.options.labelAnchor,d=L.point(c)||L.point(0,0);return d=d.add(L.Label.prototype.options.offset),b&&b.offset&&(d=d.add(b.offset)),b=L.Util.extend({offset:d},b),this._labelNoHide=b.noHide,this.label||(this._labelNoHide||this._addLabelRevealHandlers(),this.on("remove",this.hideLabel,this).on("move",this._moveLabel,this).on("add",this._onMarkerAdd,this),this._hasLabelHandlers=!0),this.label=new L.Label(b,this).setContent(a),this},unbindLabel:function(){return this.label&&(this.hideLabel(),this.label=null,this._hasLabelHandlers&&(this._labelNoHide||this._removeLabelRevealHandlers(),this.off("remove",this.hideLabel,this).off("move",this._moveLabel,this).off("add",this._onMarkerAdd,this)),this._hasLabelHandlers=!1),this},updateLabelContent:function(a){this.label&&this.label.setContent(a)},getLabel:function(){return this.label},_onMarkerAdd:function(){this._labelNoHide&&this.showLabel()},_addLabelRevealHandlers:function(){this.on("mouseover",this.showLabel,this).on("mouseout",this.hideLabel,this),L.Browser.touch&&this.on("click",this.showLabel,this)},_removeLabelRevealHandlers:function(){this.off("mouseover",this.showLabel,this).off("mouseout",this.hideLabel,this),L.Browser.touch&&this.off("click",this.showLabel,this)},_moveLabel:function(a){this.label.setLatLng(a.latlng)}},L.Icon.Default.mergeOptions({labelAnchor:new L.Point(9,-20)}),L.Marker.mergeOptions({icon:new L.Icon.Default}),L.Marker.include(L.BaseMarkerMethods),L.Marker.include({_originalUpdateZIndex:L.Marker.prototype._updateZIndex,_updateZIndex:function(a){var b=this._zIndex+a;this._originalUpdateZIndex(a),this.label&&this.label.updateZIndex(b)},_originalSetOpacity:L.Marker.prototype.setOpacity,setOpacity:function(a,b){this.options.labelHasSemiTransparency=b,this._originalSetOpacity(a)},_originalUpdateOpacity:L.Marker.prototype._updateOpacity,_updateOpacity:function(){var a=0===this.options.opacity?0:1;this._originalUpdateOpacity(),this.label&&this.label.setOpacity(this.options.labelHasSemiTransparency?this.options.opacity:a)},_originalSetLatLng:L.Marker.prototype.setLatLng,setLatLng:function(a){return this.label&&!this._labelNoHide&&this.hideLabel(),this._originalSetLatLng(a)}}),L.CircleMarker.mergeOptions({labelAnchor:new L.Point(0,0)}),L.CircleMarker.include(L.BaseMarkerMethods),L.Path.include({bindLabel:function(a,b){return this.label&&this.label.options===b||(this.label=new L.Label(b,this)),this.label.setContent(a),this._showLabelAdded||(this.on("mouseover",this._showLabel,this).on("mousemove",this._moveLabel,this).on("mouseout remove",this._hideLabel,this),L.Browser.touch&&this.on("click",this._showLabel,this),this._showLabelAdded=!0),this},unbindLabel:function(){return this.label&&(this._hideLabel(),this.label=null,this._showLabelAdded=!1,this.off("mouseover",this._showLabel,this).off("mousemove",this._moveLabel,this).off("mouseout remove",this._hideLabel,this)),this},updateLabelContent:function(a){this.label&&this.label.setContent(a)},_showLabel:function(a){this.label.setLatLng(a.latlng),this._map.showLabel(this.label)},_moveLabel:function(a){this.label.setLatLng(a.latlng)},_hideLabel:function(){this.label.close()}}),L.Map.include({showLabel:function(a){return this.addLayer(a)}}),L.FeatureGroup.include({clearLayers:function(){return this.unbindLabel(),this.eachLayer(this.removeLayer,this),this},bindLabel:function(a,b){return this.invoke("bindLabel",a,b)},unbindLabel:function(){return this.invoke("unbindLabel")},updateLabelContent:function(a){this.invoke("updateLabelContent",a)}})}(this,document),function(a,b){L.print=L.print||{},L.print.Provider=L.Class.extend({includes:L.Mixin.Events,statics:{MAX_RESOLUTION:156543.03390625,MAX_EXTENT:[-20037508.34,-20037508.34,20037508.34,20037508.34],SRS:"EPSG:3857",INCHES_PER_METER:39.3701,DPI:72,UNITS:"m"},options:{autoLoad:!1,autoOpen:!0,outputFormat:"pdf",outputFilename:"leaflet-map",method:"POST",rotation:0,customParams:{},legends:!1},initialize:function(a){if(L.version<="0.5.1")throw"Leaflet.print requires Leaflet 0.6.0+. Download latest from https://github.com/Leaflet/Leaflet/";var b;a=L.setOptions(this,a),a.map&&this.setMap(a.map),a.capabilities?this._capabilities=a.capabilities:this.options.autoLoad&&this.loadCapabilities(),a.listeners&&(a.listeners.context&&(b=a.listeners.context,delete a.listeners.context),this.addEventListener(a.listeners,b))},loadCapabilities:function(){if(this.options.url){var a;a=this.options.url+"/info.json",this.options.proxy&&(a=this.options.proxy+a),$.ajax({type:"GET",dataType:"json",url:a,success:L.Util.bind(this.onCapabilitiesLoad,this)})}},print:function(b){if(b=L.extend(L.extend({},this.options),b),!b.layout||!b.dpi)throw"Must provide a layout name and dpi value to print";this.fire("beforeprint",{provider:this,map:this._map});var c,d=JSON.stringify(L.extend({units:L.print.Provider.UNITS,srs:L.print.Provider.SRS,layout:b.layout,dpi:b.dpi,outputFormat:b.outputFormat,outputFilename:b.outputFilename,layers:this._encodeLayers(this._map),pages:[{center:this._projectCoords(L.print.Provider.SRS,this._map.getCenter()),scale:this._getScale(),rotation:b.rotation}]},this.options.customParams,b.customParams,this._makeLegends(this._map)));"GET"===b.method?(c=this._capabilities.printURL+"?spec="+encodeURIComponent(d),b.proxy&&(c=b.proxy+encodeURIComponent(c)),a.open(c),this.fire("print",{provider:this,map:this._map})):(c=this._capabilities.createURL,b.proxy&&(c=b.proxy+c),this._xhr&&this._xhr.abort(),this._xhr=$.ajax({type:"POST",contentType:"application/json; charset=UTF-8",processData:!1,dataType:"json",url:c,data:d,success:L.Util.bind(this.onPrintSuccess,this),error:L.Util.bind(this.onPrintError,this)}))},getJson:function(a){if(a=L.extend(L.extend({},this.options),a),!a.layout||!a.dpi)throw"Must provide a layout name and dpi value to print";this.fire("beforeprint",{provider:this,map:this._map});var b=L.extend({units:L.print.Provider.UNITS,srs:L.print.Provider.SRS,layout:a.layout,dpi:a.dpi,outputFormat:a.outputFormat,outputFilename:a.outputFilename,layers:this._encodeLayers(this._map),pages:[{center:this._projectCoords(L.print.Provider.SRS,this._map.getCenter()),scale:this._getScale(),rotation:a.rotation}]},this.options.customParams,a.customParams,this._makeLegends(this._map));return b},getCapabilities:function(){return this._capabilities},setMap:function(a){this._map=a},setDpi:function(a){var b=this.options.dpi;b!==a&&(this.options.dpi=a,this.fire("dpichange",{provider:this,dpi:a}))},setLayout:function(a){var b=this.options.layout;b!==a&&(this.options.layout=a,this.fire("layoutchange",{provider:this,layout:a}))},setRotation:function(a){var b=this.options.rotation;b!==this.options.rotation&&(this.options.rotation=a,this.fire("rotationchange",{provider:this,rotation:a}))},_getLayers:function(a){var b,c,d,e=[],f=[],g=[],h=[];for(d in a._layers)if(a._layers.hasOwnProperty(d)){if(!a._layers.hasOwnProperty(d))continue;var i=a._layers[d];i instanceof L.TileLayer.WMS||i instanceof L.TileLayer?g.push(i):i instanceof L.ImageOverlay?h.push(i):i instanceof L.Marker?e.push(i):i instanceof L.Path&&i.toGeoJSON&&f.push(i)}e.sort(function(a,b){return a._icon.style.zIndex-b._icon.style.zIndex});var j;for(j=1;j<e.length;j++)e[j]._icon.style.zIndex<=e[j-1]._icon.style.zIndex&&(e[j]._icon.style.zIndex=e[j-1].icons.style.zIndex+1);for(g.sort(function(a,b){return a._container.style.zIndex-b._container.style.zIndex}),j=1;j<g.length;j++)g[j]._container.style.zIndex<=g[j-1]._container.style.zIndex&&(g[j]._container.style.zIndex=g[j-1]._container.style.zIndex+1);return b=[].slice.call(this,a._panes.overlayPane.childNodes),h.sort(function(a,c){return b.indexOf(a._image)-b.indexOf(c._image)}),a._pathRoot&&(c=[].slice.call(this,a._pathRoot.childNodes),f.sort(function(a,b){return c.indexOf(a._container)-c.indexOf(b._container)})),g.concat(f).concat(h).concat(e)},_getScale:function(){for(var a,b,c=this._map,d=c.getBounds(),e=1e3*L.print.Provider.INCHES_PER_METER,f=this._capabilities.scales,g=d.getSouthWest(),h=d.getNorthEast(),i=(g.lat+h.lat)/2,j=L.latLng(i,g.lng),k=L.latLng(i,h.lng),l=j.distanceTo(k),m=c.getSize().x,n=l/m/1e3,o=(n||1e-6)*e*L.print.Provider.DPI,p=Number.POSITIVE_INFINITY,q=f.length;q--;)a=Math.abs(o-f[q].value),p>a&&(p=a,b=parseInt(f[q].value,10));
return b},_getLayoutByName:function(a){var b,c,d;for(c=0,d=this._capabilities.layouts.length;d>c;c++)if(this._capabilities.layouts[c].name===a){b=this._capabilities.layouts[c];break}return b},_encodeLayers:function(a){var b,c,d=[],e=[],f=this._getLayers(a);for(c=0;c<f.length;c++)b=f[c],b instanceof L.TileLayer.WMS?d.push(this._encoders.layers.tilelayerwms.call(this,b)):L.mapbox&&b instanceof L.mapbox.TileLayer?d.push(this._encoders.layers.tilelayermapbox.call(this,b)):b instanceof L.TileLayer?d.push(this._encoders.layers.tilelayer.call(this,b)):b instanceof L.ImageOverlay?d.push(this._encoders.layers.image.call(this,b)):(b instanceof L.Marker||b instanceof L.Path&&b.toGeoJSON)&&e.push(b);return e.length&&d.push(this._encoders.layers.vector.call(this,e)),d},_makeLegends:function(a,b){if(!this.options.legends)return[];var c,d,e,f,g,h,i=[],j=this._getLayers(a);for(f=0;f<j.length;f++)if(g=j[f],g instanceof L.TileLayer.WMS){if(h={name:g.options.title||g.wmsParams.layers,classes:[]},c={SERVICE:"WMS",LAYER:g.wmsParams.layers,REQUEST:"GetLegendGraphic",VERSION:g.wmsParams.version,FORMAT:g.wmsParams.format,STYLE:g.wmsParams.styles,WIDTH:15,HEIGHT:15},c=L.extend(c,b),e=L.Util.template(g._url),d=g.wmsParams.layers.split(","),1===d.length)h.icons=[this._getAbsoluteUrl(e+L.Util.getParamString(c,e,!0))];else for(f=0;f<d.length;f++)c.LAYER=d[f],h.classes.push({name:d[f],icons:[this._getAbsoluteUrl(e+L.Util.getParamString(c,e,!0))]});i.push(h)}return{legends:i}},_encoders:{layers:{httprequest:function(a){var b=a._url;return-1!==b.indexOf("{s}")&&(b=b.replace("{s}",a.options.subdomains[0])),b=this._getAbsoluteUrl(b),{baseURL:b,opacity:a.options.opacity}},tilelayer:function(a){var b,c,d,e=this._encoders.layers.httprequest.call(this,a),f=a._url.substring(0,a._url.indexOf("{z}")),g=[];for(-1!==f.indexOf("{s}")&&(f=f.replace("{s}",a.options.subdomains[0])),b=0;b<=a.options.maxZoom;++b)g.push(L.print.Provider.MAX_RESOLUTION/Math.pow(2,b));return a.options.tms?(c=f.split("/"),d=c[c.length-2],c.splice(-3),f=c.join("/")+"/",L.extend(e,{type:"TMS",baseURL:f,layer:d,format:"png",tileSize:[a.options.tileSize,a.options.tileSize],maxExtent:L.print.Provider.MAX_EXTENT,resolutions:g,tileOrigin:{x:L.print.Provider.MAX_EXTENT[0],y:L.print.Provider.MAX_EXTENT[0]},singleTile:!1})):L.extend(e,{type:"OSM",baseURL:f,extension:"png",tileSize:[a.options.tileSize,a.options.tileSize],maxExtent:L.print.Provider.MAX_EXTENT,resolutions:g,tileOrigin:{x:L.print.Provider.MAX_EXTENT[0],y:L.print.Provider.MAX_EXTENT[0]},singleTile:!1})},tilelayerwms:function(a){var b,c=this._encoders.layers.httprequest.call(this,a),d=a.options;L.extend(c,{type:"WMS",layers:[d.layers].join(",").split(",").filter(function(a){return""!==a}),format:d.format,styles:[d.styles].join(",").split(",").filter(function(a){return""!==a}),singleTile:!1});for(b in a.wmsParams)a.wmsParams.hasOwnProperty(b)&&-1==="detectretina,format,height,layers,request,service,srs,styles,version,width".indexOf(b.toLowerCase())&&(c.customParams||(c.customParams={}),c.customParams[b]=a.wmsParams[b]);return c},tilelayermapbox:function(a){var b,c=[];for(b=0;b<=a.options.maxZoom;++b)c.push(L.print.Provider.MAX_RESOLUTION/Math.pow(2,b));var d={};return"string"==typeof a.options.access_token&&a.options.access_token.length>0&&(d.access_token=a.options.access_token),{type:"OSM",baseURL:a.options.tiles[0].substring(0,a.options.tiles[0].indexOf("{z}")),opacity:a.options.opacity,extension:"png",tileSize:[a.options.tileSize,a.options.tileSize],maxExtent:L.print.Provider.MAX_EXTENT,resolutions:c,singleTile:!1,customParams:d}},image:function(a){return{type:"Image",opacity:a.options.opacity,name:"image",baseURL:this._getAbsoluteUrl(a._url),extent:this._projectBounds(L.print.Provider.SRS,a._bounds)}},vector:function(a){var b,c,d,e,f,g,h,i,j=[],k={},l={},m={},n=1;for(h=0,i=a.length;i>h;h++){if(c=a[h],c instanceof L.Marker){var o=c.options.icon,p=o.options.iconUrl||L.Icon.Default.imagePath+"/marker-icon.png",q=L.Util.isArray(o.options.iconSize)?new L.Point(o.options.iconSize[0],o.options.iconSize[1]):o.options.iconSize,r=L.Util.isArray(o.options.iconAnchor)?new L.Point(o.options.iconAnchor[0],o.options.iconAnchor[1]):o.options.iconAnchor,s=this.options.dpi/L.print.Provider.DPI;d={externalGraphic:this._getAbsoluteUrl(p),graphicWidth:q.x/s,graphicHeight:q.y/s,graphicXOffset:-r.x/s,graphicYOffset:-r.y/s}}else d=this._extractFeatureStyle(c);e=JSON.stringify(d),l=m[e],l?f=l:(m[e]=f=n++,k[f]=d),g=c instanceof L.Circle?this._circleGeoJSON(c):c.toGeoJSON(),g.geometry.coordinates=this._projectCoords(L.print.Provider.SRS,g.geometry.coordinates),g.properties._leaflet_style=f,null===b&&(b=c.options.opacity||1),j.push(g)}return{type:"Vector",styles:k,opacity:b,styleProperty:"_leaflet_style",geoJson:{type:"FeatureCollection",features:j}}}}},_circleGeoJSON:function(a){var b,c=a._map.options.crs.projection,d=1;c===L.Projection.SphericalMercator?d=6378137:c===L.Projection.Mercator&&(d=c.R_MAJOR);var e=c.project(a.getLatLng()),f=1/Math.cos(a.getLatLng().lat*Math.PI/180),g=[];for(b=0;64>b;b++){var h=2*b*Math.PI/64,i=L.point(Math.cos(h),Math.sin(h));g.push(c.unproject(e.add(i.multiplyBy(a.getRadius()*f/d))))}return L.polygon(g).toGeoJSON()},_extractFeatureStyle:function(a){var b=a.options;return{stroke:b.stroke,strokeColor:b.color,strokeWidth:b.weight,strokeOpacity:b.opacity,strokeLinecap:"round",fill:b.fill,fillColor:b.fillColor||b.color,fillOpacity:b.fillOpacity}},_getAbsoluteUrl:function(a){var c;return L.Browser.ie?(c=b.createElement("a"),c.style.display="none",b.body.appendChild(c),c.href=a,b.body.removeChild(c)):(c=b.createElement("a"),c.href=a),c.href},_projectBounds:function(a,b){var c=b.getSouthWest(),d=b.getNorthEast();return this._projectCoords(a,c).concat(this._projectCoords(a,d))},_projectCoords:function(a,b){var c=a.toUpperCase().replace(":",""),d=L.CRS[c];if(!d)throw"Unsupported coordinate reference system: "+a;return this._project(d,b)},_project:function(a,b){var c,d,e,f;if("number"==typeof b[0]&&(b=new L.LatLng(b[1],b[0])),b instanceof L.LatLng)return d=a.project(b),[d.x,d.y];for(c=[],e=0,f=b.length;f>e;e++)c.push(this._project(a,b[e]));return c},onCapabilitiesLoad:function(a){this._capabilities=a,this.options.layout||(this.options.layout=this._capabilities.layouts[0].name),this.options.dpi||(this.options.dpi=this._capabilities.dpis[0].value),this.fire("capabilitiesload",{provider:this,capabilities:this._capabilities})},onPrintSuccess:function(b){var c=b.getURL+(L.Browser.ie?"?inline=true":"");this.options.autoOpen&&(L.Browser.ie?a.open(c):a.location.href=c),this._xhr=null,this.fire("print",{provider:this,response:b})},onPrintError:function(a){this._xhr=null,this.fire("printexception",{provider:this,response:a})}}),L.print.provider=function(a){return new L.print.Provider(a)},L.Control.Print=L.Control.extend({options:{position:"topleft",showLayouts:!0},initialize:function(a){L.Control.prototype.initialize.call(this,a),this._actionButtons={},this._actionsVisible=!1,this._provider=this.options.provider&&this.options.provider instanceof L.print.Provider?this.options.provider:L.print.Provider(this.options.provider||{})},onAdd:function(a){var b,c,d=L.DomUtil.create("div","leaflet-control-print"),e=L.DomUtil.create("div","leaflet-bar",d);return this._toolbarContainer=e,c=L.DomUtil.create("a","leaflet-print-print",e),c.href="#",c.title="Print map",L.DomEvent.on(c,"click",L.DomEvent.stopPropagation).on(c,"mousedown",L.DomEvent.stopPropagation).on(c,"dblclick",L.DomEvent.stopPropagation).on(c,"click",L.DomEvent.preventDefault).on(c,"click",this.onPrint,this),this.options.showLayouts&&(b=this._provider.getCapabilities(),b?this._createActions(d,b):this._provider.once("capabilitiesload",this.onCapabilitiesLoad,this)),this._provider.setMap(a),d},onRemove:function(){var a,b;for(a in this._actionButtons)this._actionButtons.hasOwnProperty(a)&&(b=this._actionButtons[a],this._disposeButton(b.button,b.callback,b.scope));this._actionButtons={},this._actionsContainer=null},getProvider:function(){return this._provider},_createActions:function(a,b){var c,d,e,f=b.layouts,g=f.length,h=L.DomUtil.create("ul","leaflet-print-actions",a),i=100,j=g*i+(g-1);for(h.style.width=j+"px",e=0;g>e;e++)d=L.DomUtil.create("li","",h),c=this._createButton({title:"Print map using the "+f[e].name+" layout",text:this._ellipsis(f[e].name,16),container:d,callback:this.onActionClick,context:this}),this._actionButtons[L.stamp(c)]={name:f[e].name,button:c,callback:this.onActionClick,context:this};this._actionsContainer=h},_createButton:function(a){var b=L.DomUtil.create("a",a.className||"",a.container);return b.href="#",a.text&&(b.innerHTML=a.text),a.title&&(b.title=a.title),L.DomEvent.on(b,"click",L.DomEvent.stopPropagation).on(b,"mousedown",L.DomEvent.stopPropagation).on(b,"dblclick",L.DomEvent.stopPropagation).on(b,"click",L.DomEvent.preventDefault).on(b,"click",a.callback,a.context),b},_showActionsToolbar:function(){L.DomUtil.addClass(this._toolbarContainer,"leaflet-print-actions-visible"),this._actionsContainer.style.display="block",this._actionsVisible=!0},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-print-actions-visible"),this._actionsVisible=!1},_ellipsis:function(a,b){return a&&a.length>b&&(a=a.substr(0,b-3)+"..."),a},onCapabilitiesLoad:function(a){this._createActions(this._container,a.capabilities)},onActionClick:function(a){var b,c,d=""+L.stamp(a.target);for(c in this._actionButtons)if(this._actionButtons.hasOwnProperty(c)&&c===d){b=this._actionButtons[c],this._provider.print({layout:b.name});break}this._hideActionsToolbar()},onPrint:function(){this.options.showLayouts?this._actionsVisible?this._hideActionsToolbar():this._showActionsToolbar():this._provider.print()}}),L.control.print=function(a){return new L.Control.Print(a)}}(this,document),L.Editable=L.Class.extend({includes:[L.Mixin.Events],statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:L.Polygon,polylineClass:L.Polyline,markerClass:L.Marker,drawingCSSClass:"leaflet-editable-drawing"},initialize:function(a,b){L.setOptions(this,b),this._lastZIndex=this.options.zIndex,this.map=a,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.newClickHandler=this.createNewClickHandler(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(a,b){b=b||{},b.editTools=this,this.fire(a,b),this.map.fire(a,b)},createLineGuide:function(){var a=L.extend({dashArray:"5,10",weight:1},this.options.lineGuideOptions);return L.polyline([],a)},createVertexIcon:function(a){return L.Browser.touch?new L.Editable.TouchVertexIcon(a):new L.Editable.VertexIcon(a)},createNewClickHandler:function(){return L.marker(this.map.getCenter(),{icon:this.createVertexIcon({className:"leaflet-div-icon leaflet-drawing-icon"}),opacity:0,zIndexOffset:this._lastZIndex})},createEditLayer:function(){return this.options.editLayer||(new L.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new L.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(a){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=a,this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(a){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=a,this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(a){this.forwardLineGuide._latlngs[0]=a,this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(a){this.backwardLineGuide._latlngs[0]=a,this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide._latlngs=[],this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide._latlngs=[],this.editLayer.removeLayer(this.backwardLineGuide)},updateNewClickHandlerZIndex:function(){this._lastZIndex+=2,this.newClickHandler.setZIndexOffset(this._lastZIndex)},registerForDrawing:function(a){this.map.on("mousemove touchmove",a.onMouseMove,a),this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this._drawingEditor=a,this.editLayer.addLayer(this.newClickHandler),this.newClickHandler.on("click",a.onNewClickHandlerClicked,a),L.Browser.touch&&this.map.on("click",a.onTouch,a),L.DomUtil.addClass(this.map._container,this.options.drawingCSSClass),this.updateNewClickHandlerZIndex()},unregisterForDrawing:function(a){a=a||this._drawingEditor,this.editLayer.removeLayer(this.newClickHandler),a&&(this.map.off("mousemove touchmove",a.onMouseMove,a),this.newClickHandler.off("click",a.onNewClickHandlerClicked,a),L.Browser.touch&&this.map.off("click",a.onTouch,a),a===this._drawingEditor&&(delete this._drawingEditor,a.drawing&&a.cancelDrawing(),L.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass)))},stopDrawing:function(){this.unregisterForDrawing()},connectCreatedToMap:function(a){return this.featuresLayer.addLayer(a)},startPolyline:function(a,b){var c=this.createPolyline([],b);this.connectCreatedToMap(c);var d=c.enableEdit();return d.startDrawingForward(),a&&d.newPointForward(a),c},startPolygon:function(a,b){var c=this.createPolygon([],b);this.connectCreatedToMap(c);var d=c.enableEdit();return d.startDrawingForward(),a&&d.newPointForward(a),c},startMarker:function(a,b){a=a||this.map.getCenter();var c=this.createMarker(a,b);this.connectCreatedToMap(c);var d=c.enableEdit();return d.startDrawing(),c},startHole:function(a,b){a.newHole(b)},extendMultiPolygon:function(a){var b=this.createPolygon([]);a.addLayer(b),b.multi=a;var c=b.enableEdit();return c.startDrawingForward(),b},createPolyline:function(a,b){b=L.Util.extend({editOptions:{editTools:this}},b);var c=new this.options.polylineClass(a,b);return this.fireAndForward("editable:created",{layer:c}),c},createPolygon:function(a,b){b=L.Util.extend({editOptions:{editTools:this}},b);var c=new this.options.polygonClass(a,b);return this.fireAndForward("editable:created",{layer:c}),c},createMarker:function(a,b){b=L.Util.extend({editOptions:{editTools:this}},b);var c=new this.options.markerClass(a,b);return this.fireAndForward("editable:created",{layer:c}),c}}),L.Map.addInitHook(function(){this.whenReady(function(){this.options.editable&&(this.editTools=new L.Editable(this,this.options.editOptions))})}),L.Editable.VertexIcon=L.DivIcon.extend({options:{iconSize:new L.Point(8,8)}}),L.Editable.TouchVertexIcon=L.Editable.VertexIcon.extend({options:{iconSize:new L.Point(20,20)}}),L.Editable.VertexMarker=L.Marker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(a,b,c,d){this.latlng=a,this.latlngs=b,this.editor=c,L.Marker.prototype.initialize.call(this,a,d),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.latlng.__vertex=this,this.editor.editLayer.addLayer(this),this.setZIndexOffset(c.tools._lastZIndex+1)},onAdd:function(a){L.Marker.prototype.onAdd.call(this,a),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.addMiddleMarkers()},onRemove:function(a){this.middleMarker&&this.middleMarker.delete(),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),L.Marker.prototype.onRemove.call(this,a)},onDrag:function(a){a.vertex=this,this.editor.onVertexMarkerDrag(a);var b=L.DomUtil.getPosition(this._icon),c=this._map.layerPointToLatLng(b);this.latlng.lat=c.lat,this.latlng.lng=c.lng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng();var d=this.getNext();d&&d.middleMarker&&d.middleMarker.updateLatLng()},onDragStart:function(a){a.vertex=this,this.editor.onVertexMarkerDragStart(a)},onDragEnd:function(a){a.vertex=this,this.editor.onVertexMarkerDragEnd(a)},onClick:function(a){a.vertex=this,this.editor.onVertexMarkerClick(a)},onContextMenu:function(a){a.vertex=this,this.editor.onVertexMarkerContextMenu(a)},onMouseDown:function(a){a.vertex=this,this.editor.onVertexMarkerMouseDown(a)},"delete":function(){var a=this.getNext();this.latlngs.splice(this.latlngs.indexOf(this.latlng),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),a&&a.resetMiddleMarker()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(this.latlngs.length<2)){var a=this.getIndex(),b=a-1;0===a&&this.editor.CLOSED&&(b=this.getLastIndex());var c=this.latlngs[b];return c?c.__vertex:void 0}},getNext:function(){if(!(this.latlngs.length<2)){var a=this.getIndex(),b=a+1;a===this.getLastIndex()&&this.editor.CLOSED&&(b=0);var c=this.latlngs[b];return c?c.__vertex:void 0}},addMiddleMarker:function(a){a=a||this.getPrevious(),a&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(a,this,this.latlngs,this.editor))},addMiddleMarkers:function(){if(!this.editor.tools.options.skipMiddleMarkers){var a=this.getPrevious();a&&this.addMiddleMarker(a);var b=this.getNext();b&&b.resetMiddleMarker()}},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker.delete(),this.addMiddleMarker()},_initInteraction:function(){L.Marker.prototype._initInteraction.call(this),L.DomEvent.on(this._icon,"touchstart",function(a){this._fireMouseEvent(a)},this)}}),L.Editable.mergeOptions({vertexMarkerClass:L.Editable.VertexMarker}),L.Editable.MiddleMarker=L.Marker.extend({options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon"},initialize:function(a,b,c,d,e){this.left=a,this.right=b,this.editor=d,this.latlngs=c,L.Marker.prototype.initialize.call(this,this.computeLatLng(),e),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this),this.setVisibility()},setVisibility:function(){var a=this._map.latLngToContainerPoint(this.left.latlng),b=this._map.latLngToContainerPoint(this.right.latlng),c=L.point(this.options.icon.options.iconSize);a.distanceTo(b)<3*c.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var a=this.editor.map.latLngToContainerPoint(this.left.latlng),b=this.editor.map.latLngToContainerPoint(this.right.latlng),c=(a.y+b.y)/2,d=(a.x+b.x)/2;return this.editor.map.containerPointToLatLng([d,c])},onAdd:function(a){L.Marker.prototype.onAdd.call(this,a),this.on("mousedown touchstart",this.onMouseDown),a.on("zoomend",this.setVisibility,this)},onRemove:function(a){delete this.right.middleMarker,this.off("mousedown touchstart",this.onMouseDown),a.off("zoomend",this.setVisibility,this),L.Marker.prototype.onRemove.call(this,a)},onMouseDown:function(a){this.editor.onMiddleMarkerMouseDown(a,this),this.latlngs.splice(this.index(),0,a.latlng),this.editor.refresh();var b=this.editor.addVertexMarker(a.latlng,this.latlngs);b.dragging._draggable._onDown(a.originalEvent),this.delete()},"delete":function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)},_initInteraction:function(){L.Marker.prototype._initInteraction.call(this),L.DomEvent.on(this._icon,"touchstart",function(a){this._fireMouseEvent(a)},this)}}),L.Editable.mergeOptions({middleMarkerClass:L.Editable.MiddleMarker}),L.Editable.BaseEditor=L.Class.extend({initialize:function(a,b,c){L.setOptions(this,c),this.map=a,this.feature=b,this.feature.editor=this,this.editLayer=new L.LayerGroup,this.tools=this.options.editTools||a.editTools},enable:function(){return this._enabled?this:(this.tools.editLayer.addLayer(this.editLayer),this.onEnable(),this._enabled=!0,this.feature.on("remove",this.disable,this),this)},disable:function(){return this.feature.off("remove",this.disable,this),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),delete this._enabled,this.drawing&&this.cancelDrawing(),this},fireAndForward:function(a,b){b=b||{},b.layer=this.feature,this.feature.fire(a,b),this.feature.multi&&this.feature.multi.fire(a,b),this.tools.fireAndForward(a,b)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(){this.fireAndForward("editable:drawing:commit")},startDrawing:function(){this.drawing||(this.drawing=L.Editable.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(){this.onCommitDrawing(),this.endDrawing()},cancelDrawing:function(){this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this.drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onMouseMove:function(a){this.drawing&&this.tools.newClickHandler.setLatLng(a.latlng)},onTouch:function(a){this.onMouseMove(a),this.drawing&&this.tools.newClickHandler._fireMouseEvent(a)},onNewClickHandlerClicked:function(a){this.fireAndForward("editable:drawing:click",a)},isNewClickValid:function(){return!0}}),L.Editable.MarkerEditor=L.Editable.BaseEditor.extend({enable:function(){return this._enabled?this:(L.Editable.BaseEditor.prototype.enable.call(this),this.feature.dragging.enable(),this.feature.on("dragstart",this.onEditing,this),this)},disable:function(){return L.Editable.BaseEditor.prototype.disable.call(this),this.feature.dragging.disable(),this.feature.off("dragstart",this.onEditing,this),this},onMouseMove:function(a){this.drawing&&(L.Editable.BaseEditor.prototype.onMouseMove.call(this,a),this.feature.setLatLng(a.latlng),this.tools.newClickHandler._bringToFront())},onNewClickHandlerClicked:function(a){this.isNewClickValid(a.latlng)&&(L.Editable.BaseEditor.prototype.onNewClickHandlerClicked.call(this,a),this.commitDrawing())}}),L.Editable.PathEditor=L.Editable.BaseEditor.extend({CLOSED:!1,MIN_VERTEX:2,enable:function(){return this._enabled?this:(L.Editable.BaseEditor.prototype.enable.call(this),this.feature&&this.initVertexMarkers(),this)},disable:function(){return L.Editable.BaseEditor.prototype.disable.call(this)},initVertexMarkers:function(){for(var a=this.getLatLngsGroups(),b=0;b<a.length;b++)this.addVertexMarkers(a[b])},getLatLngsGroups:function(){return[this.getLatLngs()]},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(a,b){return new this.tools.options.vertexMarkerClass(a,b,this)},addVertexMarkers:function(a){for(var b=0;b<a.length;b++)this.addVertexMarker(a[b],a)},addMiddleMarker:function(a,b,c){return new this.tools.options.middleMarkerClass(a,b,c,this)},onVertexMarkerClick:function(a){var b=a.vertex.getIndex();a.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(a):a.originalEvent.altKey?this.onVertexMarkerAltClick(a):a.originalEvent.shiftKey?this.onVertexMarkerShiftClick(a):b>=this.MIN_VERTEX-1&&b===a.vertex.getLastIndex()&&this.drawing===L.Editable.FORWARD?this.commitDrawing():0===b&&this.drawing===L.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX?this.commitDrawing():0===b&&this.drawing===L.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?this.commitDrawing():this.onVertexRawMarkerClick(a)},onVertexRawMarkerClick:function(a){this.vertexCanBeDeleted(a.vertex)&&(a.vertex.delete(),this.refresh())},vertexCanBeDeleted:function(a){return a.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(a){this.fireAndForward("editable:vertex:deleted",a)},onVertexMarkerCtrlClick:function(a){this.fireAndForward("editable:vertex:ctrlclick",a)},onVertexMarkerShiftClick:function(a){this.fireAndForward("editable:vertex:shiftclick",a)},onVertexMarkerAltClick:function(a){this.fireAndForward("editable:vertex:altclick",a)},onVertexMarkerContextMenu:function(a){this.fireAndForward("editable:vertex:contextmenu",a)},onVertexMarkerMouseDown:function(a){this.fireAndForward("editable:vertex:mousedown",a)},onMiddleMarkerMouseDown:function(a){this.fireAndForward("editable:middlemarker:mousedown",a)},onVertexMarkerDrag:function(a){this.fireAndForward("editable:vertex:drag",a)},onVertexMarkerDragStart:function(a){this.fireAndForward("editable:vertex:dragstart",a)},onVertexMarkerDragEnd:function(a){this.fireAndForward("editable:vertex:dragend",a)},startDrawing:function(){this._drawnLatLngs||(this._drawnLatLngs=this.getLatLngs()),L.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing(),this.tools.attachForwardLineGuide()},endDrawing:function(){L.Editable.BaseEditor.prototype.endDrawing.call(this),this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),delete this._drawnLatLngs},addLatLng:function(a){this.drawing===L.Editable.FORWARD?this._drawnLatLngs.push(a):this._drawnLatLngs.unshift(a),this.refresh(),this.addVertexMarker(a,this._drawnLatLngs)},newPointForward:function(a){this.addLatLng(a),this.tools.anchorForwardLineGuide(a),this.tools.backwardLineGuide._latlngs[0]||this.tools.anchorBackwardLineGuide(a)},newPointBackward:function(a){this.addLatLng(a),this.tools.anchorBackwardLineGuide(a)},onNewClickHandlerClicked:function(a){this.isNewClickValid(a.latlng)&&(this.drawing===L.Editable.FORWARD?this.newPointForward(a.latlng):this.newPointBackward(a.latlng),L.Editable.BaseEditor.prototype.onNewClickHandlerClicked.call(this,a))},onMouseMove:function(a){this.drawing&&(L.Editable.BaseEditor.prototype.onMouseMove.call(this,a),this.tools.moveForwardLineGuide(a.latlng),this.tools.moveBackwardLineGuide(a.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()}}),L.Editable.PolylineEditor=L.Editable.PathEditor.extend({startDrawingBackward:function(){this.drawing=L.Editable.BACKWARD,this.startDrawing(),this.tools.attachBackwardLineGuide()},continueBackward:function(){this.tools.anchorBackwardLineGuide(this.getFirstLatLng()),this.startDrawingBackward()},continueForward:function(){this.tools.anchorForwardLineGuide(this.getLastLatLng()),this.startDrawingForward()},getLastLatLng:function(){return this.getLatLngs()[this.getLatLngs().length-1]},getFirstLatLng:function(){return this.getLatLngs()[0]}}),L.Editable.PolygonEditor=L.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:3,getLatLngsGroups:function(){var a=L.Editable.PathEditor.prototype.getLatLngsGroups.call(this);if(this.feature._holes)for(var b=0;b<this.feature._holes.length;b++)a.push(this.feature._holes[b]);return a},startDrawingForward:function(){L.Editable.PathEditor.prototype.startDrawingForward.call(this),this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(){var a=Array();return this.feature._holes||(this.feature._holes=[]),this.feature._holes.push(a),a},newHole:function(a){this._drawnLatLngs=this.addNewEmptyHole(),this.startDrawingForward(),a&&this.newPointForward(a)},checkContains:function(a){return this.feature._containsPoint(this.map.latLngToLayerPoint(a))},vertexCanBeDeleted:function(a){return a.latlngs===this.getLatLngs()?L.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,a):!0},isNewClickValid:function(a){return this._drawnLatLngs!==this.getLatLngs()?this.checkContains(a):!0},onVertexDeleted:function(a){L.Editable.PathEditor.prototype.onVertexDeleted.call(this,a),a.vertex.latlngs.length||a.vertex.latlngs===this.getLatLngs()||this.feature._holes.splice(this.feature._holes.indexOf(a.vertex.latlngs),1)}}),L.Map.mergeOptions({polylineEditorClass:L.Editable.PolylineEditor}),L.Map.mergeOptions({polygonEditorClass:L.Editable.PolygonEditor}),L.Map.mergeOptions({markerEditorClass:L.Editable.MarkerEditor});var EditableMixin={createEditor:function(a){a=a||this._map;var b=this.options.editorClass||this.getEditorClass(a);return new b(a,this,this.options.editOptions)},enableEdit:function(){return this.editor||this.createEditor(),this.multi&&this.multi.onEditEnabled(),this.editor.enable()},editEnabled:function(){return this.editor&&this.editor._enabled},disableEdit:function(){this.editor&&(this.multi&&this.multi.onEditDisabled(),this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()}};L.Polyline.include(EditableMixin),L.Polygon.include(EditableMixin),L.Marker.include(EditableMixin),L.Polyline.include({_containsPoint:function(a,b){var c,d,e,f,g,h,i,j=this.options.weight/2;for(L.Browser.touch&&(j+=10),c=0,f=this._parts.length;f>c;c++)for(i=this._parts[c],d=0,g=i.length,e=g-1;g>d;e=d++)if((b||0!==d)&&(h=L.LineUtil.pointToSegmentDistance(a,i[e],i[d]),j>=h))return!0;return!1},getEditorClass:function(a){return a.options.polylineEditorClass}}),L.Polygon.include({_containsPoint:function(a){var b,c,d,e,f,g,h,i,j=!1;if(L.Polyline.prototype._containsPoint.call(this,a,!0))return!0;for(e=0,h=this._parts.length;h>e;e++)for(b=this._parts[e],f=0,i=b.length,g=i-1;i>f;g=f++)c=b[f],d=b[g],c.y>a.y!=d.y>a.y&&a.x<(d.x-c.x)*(a.y-c.y)/(d.y-c.y)+c.x&&(j=!j);return j},getEditorClass:function(a){return a.options.polygonEditorClass}}),L.Marker.include({getEditorClass:function(a){return a.options.markerEditorClass}});var MultiEditableMixin={enableEdit:function(){this.eachLayer(function(a){a.multi=this,a.enableEdit()},this)},disableEdit:function(){this.eachLayer(function(a){a.disableEdit()})},toggleEdit:function(a){a.layer.editor?this.disableEdit():this.enableEdit(a)},onEditEnabled:function(){this._editEnabled||(this._editEnabled=!0,this.fire("editable:multi:edit:enabled"))},onEditDisabled:function(){this._editEnabled&&(this._editEnabled=!1,this.fire("editable:multi:edit:disabled"))},editEnabled:function(){return!!this._editEnabled}};L.MultiPolygon.include(MultiEditableMixin),L.MultiPolyline.include(MultiEditableMixin),L.Control.GraphicScale=L.Control.extend({options:{position:"bottomleft",updateWhenIdle:!1,minUnitWidth:30,maxUnitsWidth:240,fill:!1,showSubunits:!1,doubleLine:!1},onAdd:function(a){return this._map=a,this._possibleUnitsNum=[3,5,2,4],this._possibleUnitsNumLen=this._possibleUnitsNum.length,this._possibleDivisions=[1,.5,.25,.2],this._possibleDivisionsLen=this._possibleDivisions.length,this._possibleDivisionsSub={1:{num:2,division:.5},.5:{num:5,division:.1},.25:{num:5,division:.05},.2:{num:2,division:.1}},this._scaleInner=this._buildScale(),this._scale=this._addScale(this._scaleInner),this._setStyle(this.options),a.on(this.options.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),this._scale},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScale:function(a){var b=L.DomUtil.create("div");return b.className="leaflet-control-graphicscale",b.appendChild(a),b},_setStyle:function(a){var b=["leaflet-control-graphicscale-inner"];a.fill&&"nofill"!==a.fill&&(b.push("filled"),b.push("filled-"+a.fill)),a.showSubunits&&b.push("showsubunits"),a.doubleLine&&b.push("double"),this._scaleInner.className=b.join(" ")},_buildScale:function(){var a=document.createElement("div");a.className="leaflet-control-graphicscale-inner";var b=L.DomUtil.create("div","subunits",a),c=L.DomUtil.create("div","units",a);this._units=[],this._unitsLbls=[],this._subunits=[];for(var d=0;5>d;d++){var e=this._buildDivision(d%2===0);c.appendChild(e),this._units.push(e);var f=this._buildDivisionLbl();e.appendChild(f),this._unitsLbls.push(f);var g=this._buildDivision(d%2===1);b.appendChild(g),this._subunits.unshift(g)
}return this._zeroLbl=L.DomUtil.create("div","label zeroLabel"),this._zeroLbl.innerHTML="0",this._units[0].appendChild(this._zeroLbl),this._subunitsLbl=L.DomUtil.create("div","label subunitsLabel"),this._subunitsLbl.innerHTML="?",this._subunits[4].appendChild(this._subunitsLbl),a},_buildDivision:function(a){var b=L.DomUtil.create("div","division"),c=L.DomUtil.create("div","line");b.appendChild(c);var d=L.DomUtil.create("div","line2");return b.appendChild(d),a&&c.appendChild(L.DomUtil.create("div","fill")),a||d.appendChild(L.DomUtil.create("div","fill")),b},_buildDivisionLbl:function(){var a=L.DomUtil.create("div","label divisionLabel");return a},_update:function(){var a=this._map.getBounds(),b=a.getCenter().lat,c=6378137*Math.PI*Math.cos(b*Math.PI/180),d=c*(a.getNorthEast().lng-a.getSouthWest().lng)/180,e=this._map.getSize();e.x>0&&this._updateScale(d,this.options)},_updateScale:function(a,b){var c=this._getBestScale(a,b.minUnitWidth,b.maxUnitsWidth);this._render(c)},_getBestScale:function(a,b,c){var d=this._getPossibleUnits(a,b,this._map.getSize().x),e=this._getPossibleScales(d,c);e.sort(function(a,b){return b.score-a.score});var f=e[0];return f.subunits=this._getSubunits(f),f},_getSubunits:function(a){var b=this._possibleDivisionsSub[a.unit.unitDivision],c={};c.subunitDivision=b.division,c.subunitMeters=b.division*(a.unit.unitMeters/a.unit.unitDivision),c.subunitPx=b.division*(a.unit.unitPx/a.unit.unitDivision);var d={subunit:c,numSubunits:b.num,total:b.num*c.subunitMeters};return d},_getPossibleScales:function(a,b){for(var c,d=[],e=Number.POSITIVE_INFINITY,f=0;f<this._possibleUnitsNumLen;f++)for(var g=this._possibleUnitsNum[f],h=.5*(this._possibleUnitsNumLen-f),i=0;i<a.length;i++){var j=a[i],k=j.unitPx*g,l={unit:j,totalWidthPx:k,numUnits:g,score:0},m=1-(b-k)/b;m*=3;var n=j.unitScore+h+m;(.25===j.unitDivision&&3===g||.5===j.unitDivision&&3===g||.25===j.unitDivision&&5===g)&&(n-=2),l.score=n,b>k&&d.push(l),e>k&&(e=k,c=l)}return d.length||d.push(c),d},_getPossibleUnits:function(a,b,c){for(var d,e=(Math.floor(a)+"").length,f=[],g=e;g>0;g--){d=Math.pow(10,g);for(var h=0;h<this._possibleDivisionsLen;h++){var i=d*this._possibleDivisions[h],j=c*(i/a);if(b>j)return f;f.push({unitMeters:i,unitPx:j,unitDivision:this._possibleDivisions[h],unitScore:this._possibleDivisionsLen-h})}}return f},_render:function(a){this._renderPart(a.unit.unitPx,a.unit.unitMeters,a.numUnits,this._units,this._unitsLbls),this._renderPart(a.subunits.subunit.subunitPx,a.subunits.subunit.subunitMeters,a.subunits.numSubunits,this._subunits);var b=this._getDisplayUnit(a.subunits.total);this._subunitsLbl.innerHTML=""+b.amount+b.unit},_renderPart:function(a,b,c,d,e){for(var f=this._getDisplayUnit(b),g=0;g<this._units.length;g++){var h=d[g];if(c>g?(h.style.width=a+"px",h.className="division"):(h.style.width=0,h.className="division hidden"),e){var i=e[g],j=["label","divisionLabel"];if(c>g){var k=(g+1)*f.amount;g===c-1?(k+=f.unit,j.push("labelLast")):j.push("labelSub"),i.innerHTML=k}i.className=j.join(" ")}}},_getDisplayUnit:function(a){var b=1e3>a?"m":"km";return{unit:b,amount:"km"===b?a/1e3:a}}}),L.Map.mergeOptions({graphicScaleControl:!1}),L.Map.addInitHook(function(){this.options.graphicScaleControl&&(this.graphicScaleControl=new L.Control.GraphicScale,this.addControl(this.graphicScaleControl))}),L.control.graphicScale=function(a){return new L.Control.GraphicScale(a)},function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a("undefined"!=typeof b&&b.L?L:require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.Control.Locate=a(L))}(function(a){var b=a.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPan",keepCurrentZoomLevel:!1,clickBehavior:{inView:"stop",outOfView:"setView"},drawCircle:!0,drawMarker:!0,markerClass:a.CircleMarker,circleStyle:{color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:2,opacity:.5},markerStyle:{color:"#136AEC",fillColor:"#2A93EE",fillOpacity:.7,weight:2,opacity:.9,radius:5},followCircleStyle:{},followMarkerStyle:{},icon:"fa fa-map-marker",iconLoading:"fa fa-spinner fa-spin",iconElementTag:"span",circlePadding:[0,0],metric:!0,onLocationError:function(a){alert(a.message)},onLocationOutsideMapBounds:function(a){a.stop(),alert(a.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(b){for(var c in b)"object"==typeof this.options[c]?a.extend(this.options[c],b[c]):this.options[c]=b[c];this.options.followMarkerStyle=a.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=a.extend({},this.options.circleStyle,this.options.followCircleStyle)},onAdd:function(b){var c=a.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");return this._layer=this.options.layer||new a.LayerGroup,this._layer.addTo(b),this._event=void 0,this._link=a.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",c),this._link.href="#",this._link.title=this.options.strings.title,this._icon=a.DomUtil.create(this.options.iconElementTag,this.options.icon,this._link),a.DomEvent.on(this._link,"click",a.DomEvent.stopPropagation).on(this._link,"click",a.DomEvent.preventDefault).on(this._link,"click",this._onClick,this).on(this._link,"dblclick",a.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),c},_onClick:function(){if(this._justClicked=!0,this._userPanned=!1,this._active&&!this._event)this.stop();else if(this._active&&void 0!==this._event){var a=this._map.getBounds().contains(this._event.latlng)?this.options.clickBehavior.inView:this.options.clickBehavior.outOfView;switch(a){case"setView":this.setView();break;case"stop":this.stop()}}else this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},_activate:function(){this._active||(this._map.locate(this.options.locateOptions),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this))},_deactivate:function(){this._map.stopLocate(),this._active=!1,this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this)},setView:function(){this._isOutsideMapBounds()?this.options.onLocationOutsideMapBounds(this):this.options.keepCurrentZoomLevel?this._map.panTo([this._event.latitude,this._event.longitude]):this._map.fitBounds(this._event.bounds,{padding:this.options.circlePadding,maxZoom:this.options.locateOptions.maxZoom}),this._drawMarker()},_drawMarker:function(){void 0===this._event.accuracy&&(this._event.accuracy=0);var b=this._event.accuracy,c=this._event.latlng;if(this.options.drawCircle){var d=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(c).setRadius(b).setStyle(d):this._circle=a.circle(c,b,d).addTo(this._layer)}var e,f;if(this.options.metric?(e=b.toFixed(0),f=this.options.strings.metersUnit):(e=(3.2808399*b).toFixed(0),f=this.options.strings.feetUnit),this.options.drawMarker){var g=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?this._marker.setLatLng(c).setStyle(g):this._marker=new this.options.markerClass(c,g).addTo(this._layer)}var h=this.options.strings.popup;this.options.showPopup&&h&&this._marker&&this._marker.bindPopup(a.Util.template(h,{distance:e,unit:f}))._popup.setLatLng(c)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_onLocationError:function(a){3==a.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(a,this))},_onLocationFound:function(a){if((!this._event||this._event.latlng.lat!==a.latlng.lat||this._event.latlng.lng!==a.latlng.lng||this._event.accuracy!==a.accuracy)&&this._active){switch(this._event=a,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"always":this.setView();break;case!1:}this._justClicked=!1}},_onDrag:function(){this._event&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){return this._active?"always"===this.options.setView?!0:"untilPan"===this.options.setView?!this._userPanned:void 0:!1},_isOutsideMapBounds:function(){return void 0===this._event?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle:function(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(b){"requesting"==b?(a.DomUtil.removeClasses(this._container,"active following"),a.DomUtil.addClasses(this._container,"requesting"),a.DomUtil.removeClasses(this._icon,this.options.icon),a.DomUtil.addClasses(this._icon,this.options.iconLoading)):"active"==b?(a.DomUtil.removeClasses(this._container,"requesting following"),a.DomUtil.addClasses(this._container,"active"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon)):"following"==b&&(a.DomUtil.removeClasses(this._container,"requesting"),a.DomUtil.addClasses(this._container,"active following"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon))},_cleanClasses:function(){a.DomUtil.removeClass(this._container,"requesting"),a.DomUtil.removeClass(this._container,"active"),a.DomUtil.removeClass(this._container,"following"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1}});return a.control.locate=function(b){return new a.Control.Locate(b)},function(){var b=function(b,c,d){d=d.split(" "),d.forEach(function(d){a.DomUtil[b].call(this,c,d)})};a.DomUtil.addClasses=function(a,c){b("addClass",a,c)},a.DomUtil.removeClasses=function(a,c){b("removeClass",a,c)}}(),b},window),function(a,b,c){"use strict";L._Toolbar=(L.Layer||L.Class).extend({statics:{baseClass:"leaflet-toolbar"},includes:L.Mixin.Events,options:{className:"",filter:function(){return!0},actions:[]},initialize:function(a){L.setOptions(this,a),this._toolbar_type=this.constructor._toolbar_class_id},addTo:function(a){return this._arguments=[].slice.call(arguments),a.addLayer(this),this},onAdd:function(a){var b=a._toolbars[this._toolbar_type];0===this._calculateDepth()&&(b&&a.removeLayer(b),a._toolbars[this._toolbar_type]=this)},onRemove:function(a){0===this._calculateDepth()&&delete a._toolbars[this._toolbar_type]},appendToContainer:function(a){var b,c,d,e,f,g,h=this.constructor.baseClass+"-"+this._calculateDepth(),i=h+" "+this.options.className;for(this._container=a,this._ul=L.DomUtil.create("ul",i,a),this._disabledEvents=["click","mousemove","dblclick"],e=0,g=this._disabledEvents.length;g>e;e++)L.DomEvent.on(this._ul,this._disabledEvents[e],L.DomEvent.stopPropagation);for(d=0,f=this.options.actions.length;f>d;d++)b=this._getActionConstructor(this.options.actions[d]),c=new b,c._createIcon(this,this._ul,this._arguments)},_getActionConstructor:function(a){var b=this._arguments,c=this;return a.extend({initialize:function(){a.prototype.initialize.apply(this,b)},enable:function(b){c._active&&c._active.disable(),c._active=this,a.prototype.enable.call(this,b)}})},_hide:function(){this._ul.style.display="none"},_show:function(){this._ul.style.display="block"},_calculateDepth:function(){for(var a=0,b=this.parentToolbar;b;)a+=1,b=b.parentToolbar;return a}}),L._toolbar={};var d=0;L._Toolbar.extend=function(a){var b=L.extend({},a.statics,{_toolbar_class_id:d});return d+=1,L.extend(a,{statics:b}),L.Class.extend.call(this,a)},L.Map.addInitHook(function(){this._toolbars={}}),L._ToolbarAction=L.Handler.extend({statics:{baseClass:"leaflet-toolbar-icon"},options:{toolbarIcon:{html:"",className:"",tooltip:""},subToolbar:new L._Toolbar},initialize:function(a){var b=L._ToolbarAction.prototype.options.toolbarIcon;L.setOptions(this,a),this.options.toolbarIcon=L.extend({},b,this.options.toolbarIcon)},enable:function(a){a&&L.DomEvent.preventDefault(a),this._enabled||(this._enabled=!0,this.addHooks&&this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks&&this.removeHooks())},_createIcon:function(a,b,c){var d=this.options.toolbarIcon;this.toolbar=a,this._icon=L.DomUtil.create("li","",b),this._link=L.DomUtil.create("a","",this._icon),this._link.innerHTML=d.html,this._link.setAttribute("href","#"),this._link.setAttribute("title",d.tooltip),L.DomUtil.addClass(this._link,this.constructor.baseClass),d.className&&L.DomUtil.addClass(this._link,d.className),L.DomEvent.on(this._link,"click",this.enable,this),this._addSubToolbar(a,this._icon,c)},_addSubToolbar:function(a,b,c){var d=this.options.subToolbar,e=this.addHooks,f=this.removeHooks;d.parentToolbar=a,d.options.actions.length>0&&(c=[].slice.call(c),c.push(this),d.addTo.apply(d,c),d.appendToContainer(b),this.addHooks=function(a){"function"==typeof e&&e.call(this,a),d._show()},this.removeHooks=function(a){"function"==typeof f&&f.call(this,a),d._hide()})}}),L._toolbarAction=function(a){return new L._ToolbarAction(a)},L._ToolbarAction.extendOptions=function(a){return this.extend({options:a})},L._Toolbar.Control=L._Toolbar.extend({statics:{baseClass:"leaflet-control-toolbar "+L._Toolbar.baseClass},initialize:function(a){L._Toolbar.prototype.initialize.call(this,a),this._control=new L.Control._Toolbar(this.options)},onAdd:function(a){this._control.addTo(a),L._Toolbar.prototype.onAdd.call(this,a),this.appendToContainer(this._control.getContainer())},onRemove:function(a){L._Toolbar.prototype.onRemove.call(this,a),this._control.remove?this._control.remove():this._control.removeFrom(a)}}),L.Control._Toolbar=L.Control.extend({onAdd:function(){return L.DomUtil.create("div","")}}),L._toolbar.control=function(a){return new L._Toolbar.Control(a)},L._Toolbar.Popup=L._Toolbar.extend({statics:{baseClass:"leaflet-popup-toolbar "+L._Toolbar.baseClass},options:{anchor:[0,0]},initialize:function(a,b){L._Toolbar.prototype.initialize.call(this,b),this._marker=new L.Marker(a,{icon:new L.DivIcon({className:this.options.className,iconAnchor:[0,0]})})},onAdd:function(a){this._map=a,this._marker.addTo(a),L._Toolbar.prototype.onAdd.call(this,a),this.appendToContainer(this._marker._icon),this._setStyles()},onRemove:function(a){a.removeLayer(this._marker),L._Toolbar.prototype.onRemove.call(this,a),delete this._map},setLatLng:function(a){return this._marker.setLatLng(a),this},_setStyles:function(){for(var a,b,d,e=this._container,f=this._ul,g=L.point(this.options.anchor),h=f.querySelectorAll(".leaflet-toolbar-icon"),i=[],j=0,k=0,l=h.length;l>k;k++)h[k].parentNode.parentNode===f&&(i.push(parseInt(L.DomUtil.getStyle(h[k],"height"),10)),j+=Math.ceil(parseFloat(L.DomUtil.getStyle(h[k],"width"))));f.style.width=j+"px",this._tipContainer=L.DomUtil.create("div","leaflet-toolbar-tip-container",e),this._tipContainer.style.width=j+"px",this._tip=L.DomUtil.create("div","leaflet-toolbar-tip",this._tipContainer),a=Math.max.apply(c,i),b=parseInt(L.DomUtil.getStyle(this._tip,"width"),10),d=new L.Point(j/2,a+.7071*b),e.style.marginLeft=g.x-d.x+"px",e.style.marginTop=g.y-d.y+"px"}}),L._toolbar.popup=function(a){return new L._Toolbar.Popup(a)}}(window,document);