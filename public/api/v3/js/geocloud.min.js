var geocloud;geocloud=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=function(a){a=document.getElementsByTagName("script");var b=a[a.length-1];return void 0!==b.getAttribute.length?b.src:b.getAttribute("src",-1)}(),q="osm",r="mapQuestOSM",s="mapBoxNaturalEarth",t="stamenToner",u="stamenTonerLite",v="googleStreets",w="googleHybrid",x="googleSatellite",y="googleTerrain",z="bingRoad",A="bingAerial",B="bingAerialWithLabels",C="dtkSkaermkort@25832",D="dtkSkaermkort",E="dtkSkaermkortDaempet",F="DigitalGlobe:Imagery",G="hereNormalDayGrey",H="hereNormalNightGrey",I=void 0===window.mapAttribution?"Powered by <a target='_blank' href='//www.mapcentia.com/en/geocloud/geocloud.htm'>MapCentia GC2</a> ":window.mapAttribution,J=[156543.033928,78271.516964,39135.758482,19567.879241,9783.9396205,4891.96981025,2445.98490513,1222.99245256,611.496226281,305.748113141,152.87405657,76.4370282852,38.2185141426,19.1092570713,9.55462853565,4.77731426782,2.38865713391,1.19432856696,.597164283478,.298582141739,.149291070869],K={},M={};"undefined"==typeof window.geocloud_host&&(window.geocloud_host=o="/"===p.charAt(0)?"":p.split("/")[0]+"//"+p.split("/")[2]),o=window.geocloud_host,"object"!=typeof ol&&"object"!=typeof L&&"object"!=typeof OpenLayers&&alert("You need to load neither OpenLayers.js, ol3,js or Leaflet.js"),"object"==typeof OpenLayers&&(n="ol2"),"object"==typeof ol&&(n="ol3"),"object"==typeof L&&(n="leaflet"),"loading"===document.readyState&&"undefined"==typeof jQuery&&document.write("<script src='//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>");var N=function(a){o=a};c=function(a,b){a.prototype=new b};var O={styleMap:null,visibility:!0,lifetime:0,host:o,uri:"/api/v1/sql",db:null,sql:null,q:null,name:"Vector",id:null,rendererOptions:{zIndexing:!0},projection:"leaflet"===n?"4326":"900913",pointToLayer:function(a,b){return L.circleMarker(b)},onEachFeature:function(){},onLoad:function(){},index:"",type:"",size:100,clientEncoding:"UTF8",async:!0,jsonp:!0,method:"GET",clickable:!0,error:function(){}};return b=function(){this.hide=function(){this.layer.setVisibility(!1)},this.show=function(){this.layer.setVisibility(!0)},this.map=null,this.init=function(){switch(this.onLoad=this.defaults.onLoad,n){case"ol2":this.layer=new OpenLayers.Layer.Vector(this.defaults.name,{styleMap:this.defaults.styleMap,visibility:this.defaults.visibility,renderers:["Canvas","SVG","VML"],rendererOptions:this.defaults.rendererOptions});break;case"ol3":this.layer=new ol.layer.Vector({source:new ol.source.GeoJSON,style:this.defaults.styleMap}),this.layer.id=this.defaults.name;break;case"leaflet":this.layer=L.geoJson(null,{style:this.defaults.styleMap,pointToLayer:this.defaults.pointToLayer,onEachFeature:this.defaults.onEachFeature,clickable:this.defaults.clickable}),this.layer.id=this.defaults.name}},this.geoJSON=null,this.featureStore=null,this.reset=function(){switch(n){case"ol2":this.layer.destroyFeatures();break;case"leaflet":this.layer.clearLayers()}},this.isEmpty=function(){switch(n){case"ol2":return 0===this.layer.features.length?!0:!1;case"leaflet":return 0===Object.keys(this.layer._layers).length?!0:!1}},this.getWKT=function(){return(new OpenLayers.Format.WKT).write(this.layer.features)}},d=f=function(a){var b,c,d,e,f=this;if(this.defaults=$.extend({},O),a)for(b in a)this.defaults[b]=a[b];this.init(),this.name=this.defaults.name,this.id=this.defaults.id,this.sql=this.defaults.sql,this.db=this.defaults.db,this.host=this.defaults.host.replace("cdn.",""),this.onLoad=this.defaults.onLoad,this.dataType=this.defaults.dataType,this.async=this.defaults.async,this.jsonp=this.defaults.jsonp,this.method=this.defaults.method,this.uri=this.defaults.uri,this.load=function(a){try{c=f.map,d=this.sql,d=d.replace("{centerX}",c.getCenter().lat.toString()),d=d.replace("{centerY}",c.getCenter().lon.toString()),d=d.replace("{minX}",c.getExtent().left),d=d.replace("{maxX}",c.getExtent().right),d=d.replace("{minY}",c.getExtent().bottom),d=d.replace("{maxY}",c.getExtent().top),d=d.replace("{bbox}",c.getExtent().toString())}catch(b){}return e=$.ajax({dataType:this.defaults.jsonp?"jsonp":"json",async:this.defaults.async,data:"q="+encodeURIComponent(d)+"&srs="+this.defaults.projection+"&lifetime="+this.defaults.lifetime+"&client_encoding="+this.defaults.clientEncoding,jsonp:this.defaults.jsonp?"jsonp_callback":!1,url:this.host+this.uri+"/"+this.db,type:this.defaults.method,success:function(b){if(b.success===!1&&void 0===a&&alert(b.message),b.success===!0)if(null!==b.features)switch(f.geoJSON=b,n){case"ol2":f.layer.addFeatures((new OpenLayers.Format.GeoJSON).read(b));break;case"ol3":f.layer.getSource().addFeatures(new ol.source.GeoJSON({object:b.features[0]}));break;case"leaflet":f.layer.addData(b)}else f.geoJSON=null},error:this.defaults.error,complete:function(){f.onLoad()}}),this.layer},this.abort=function(){e.abort()}},e=function(a){var b,c,d,e=this;if(this.defaults=$.extend({},O),a)for(b in a)this.defaults[b]=a[b];this.init(),this.name=this.defaults.name,this.id=this.defaults.id,this.sql=this.defaults.sql,this.db=this.defaults.db,this.onLoad=this.defaults.onLoad,this.dataType=this.defaults.dataType,this.async=this.defaults.async,this.jsonp=this.defaults.jsonp,this.method=this.defaults.method,this.load=function(){try{c=e.map,d=this.sql,d=d.replace("{centerX}",c.getCenter().lat.toString()),d=d.replace("{centerY}",c.getCenter().lon.toString()),d=d.replace("{minX}",c.getExtent().left),d=d.replace("{maxX}",c.getExtent().right),d=d.replace("{minY}",c.getExtent().bottom),d=d.replace("{maxY}",c.getExtent().top),d=d.replace("{bbox}",c.getExtent().toString())}catch(a){}return $.ajax({dataType:this.defaults.jsonp?"jsonp":"json",async:this.defaults.async,data:"format=geojson&q="+encodeURIComponent(d)+"&srs="+this.defaults.projection+"&lifetime="+this.defaults.lifetime+"&srs="+this.defaults.projection+"&client_encoding="+this.defaults.clientEncoding,jsonp:this.defaults.jsonp?"callback":!1,url:"http://"+this.db+".cartodb.com/api/v2/sql",type:this.defaults.method,success:function(a){if(null!==a.features)switch(e.geoJSON=a,n){case"ol2":e.layer.addFeatures((new OpenLayers.Format.GeoJSON).read(a));break;case"ol3":e.layer.getSource().addFeatures(new ol.source.GeoJSON({object:a.features[0]}));break;case"leaflet":e.layer.addData(a)}else e.geoJSON=null},error:this.defaults.error,complete:function(){e.onLoad()}}),this.layer}},g=function(a){var b,c=this;if(this.defaults=$.extend({},O),a)for(b in a)this.defaults[b]=a[b];this.init(),this.load=function(a){var b=this.defaults.q;try{var d=c.map;b=b.replace(/\{minX\}/g,d.getExtent().left),b=b.replace(/\{maxX\}/g,d.getExtent().right),b=b.replace(/\{minY\}/g,d.getExtent().bottom),b=b.replace(/\{maxY\}/g,d.getExtent().top),b=b.replace(/\{bbox\}/g,d.getExtent().toString())}catch(e){}return $.ajax({dataType:"jsonp",data:"search="+encodeURIComponent(b),jsonp:"jsonp_callback",url:this.defaults.host+"/api/v1/twitter/"+this.db,success:function(b){if(b.success===!1&&void 0===a&&alert(b.message),b.success===!0&&null!==b.features)switch(c.geoJSON=b,n){case"ol2":c.layer.addFeatures((new OpenLayers.Format.GeoJSON).read(b));break;case"leaflet":c.layer.addData(b)}},complete:function(){c.onLoad()}}),this.layer}},h=function(a){var b,c=this;if(this.defaults=$.extend({},O),a)for(b in a)this.defaults[b]=a[b];this.init(),this.q=this.defaults.q,this.db=this.defaults.db,this.host=this.defaults.host.replace("cdn.",""),this.onLoad=this.defaults.onLoad,this.total=0,this.size=this.defaults.size,this.dataType=this.defaults.dataType,this.async=this.defaults.async,this.jsonp=this.defaults.jsonp,this.method=this.defaults.method,this.load=function(){var a=c.map,b=this.q;try{b=b.replace("{minX}",a.getExtent().left),b=b.replace("{maxX}",a.getExtent().right),b=b.replace("{minY}",a.getExtent().bottom),b=b.replace("{maxY}",a.getExtent().top),b=b.replace("{bbox}",a.getExtent().toString())}catch(d){}return $.ajax({method:this.method,dataType:this.jsonp?"jsonp":"json",async:this.async,jsonp:this.jsonp?"jsonp_callback":!1,data:"q="+encodeURIComponent(b)+"&size="+this.size,url:this.defaults.host+"/api/v1/elasticsearch/search/"+this.defaults.db+"/"+this.defaults.index+"/"+this.defaults.type,success:function(a){if("undefined"!=typeof a.error)return!1;var b=[],d={type:"FeatureCollection"};if(c.total=a.hits.total,$.each(a.hits.hits,function(a,c){b.push(c._source)}),d.features=b,null!==a.features)switch(c.geoJSON=d,n){case"ol2":c.layer.addFeatures(new OpenLayers.Format.GeoJSON({internalProjection:new OpenLayers.Projection("EPSG:3857"),externalProjection:new OpenLayers.Projection("EPSG:4326")}).read(d));break;case"leaflet":c.layer.addData(d)}},complete:function(a){c.onLoad(a)}}),this.layer}},c(f,b),c(g,b),c(h,b),c(e,b),i=function(a){var b,c={host:o,layer:null,db:null,singleTile:!1,opacity:1,wrapDateLine:!0,tileCached:!0,name:null,isBaseLayer:!1,resolutions:J};if(a)for(b in a)c[b]=a[b];return j(c.layer,c)},j=function(a,b){var c,d,e,f;if(c=a.split("."),b.tileCached){e=b.host+"/mapcache/"+b.db+"/wms";var g=e,h=e,i=e;f=[g.replace("cdn.","cdn1."),h.replace("cdn.","cdn2."),i.replace("cdn.","cdn3.")],e=e.replace("cdn.","{s}.")}else e=b.host+"/wms/"+b.db+"/"+c[0]+"?",f=[e];switch(n){case"ol2":d=new OpenLayers.Layer.WMS(b.name,f,{layers:a,transparent:!0},b),d.id=a;break;case"ol3":d=new ol.layer.Tile({source:new ol.source.TileWMS({url:e,params:{LAYERS:a}}),visible:b.visibility}),d.id=a;break;case"leaflet":d=new L.TileLayer.WMS(e,{layers:a,format:"image/png",transparent:!0,subdomains:["cdn1","cdn2","cdn3"],maxZoom:20}),d.id=a}return d},k=function(a,b){var c,d,e;d=b.host+"/mapcache/"+b.db+"/tms/";var f=d,g=d,h=d;switch(e=[f.replace("cdn.","cdn1."),g.replace("cdn.","cdn2."),h.replace("cdn.","cdn3.")],d=d.replace("cdn.","{s}."),n){case"ol2":c=new OpenLayers.Layer.TMS(b.name,e,{layername:a,type:"png",resolutions:b.resolutions,isBaseLayer:b.isBaseLayer}),c.id=a;break;case"ol3":break;case"leaflet":c=new L.TileLayer(d+"1.0.0/"+a+"/{z}/{x}/{y}.png",{tms:!0,maxZoom:20,tileSize:256}),c.id=a}return c},a=function(a){var b,c,d=[],e={numZoomLevels:20,projection:"EPSG:900913",fadeAnimation:!0,zoomAnimation:!0,showLayerSwitcher:!1,resolutions:J,editable:!0};if(a)for(b in a)e[b]=a[b];switch("leaflet"===n&&$("<link/>").attr({rel:"stylesheet",type:"text/css",href:o+"/js/leaflet/leaflet.css"}).appendTo("head"),this.bingApiKey=null,this.digitalGlobeKey=null,this.zoomToExtent=function(a,b){var c,d;switch(n){case"ol2":a?this.map.zoomToExtent(new OpenLayers.Bounds(a),b):this.map.zoomToExtent(this.map.maxExtent);break;case"ol3":a?this.map.zoomToExtent(new OpenLayers.Bounds(a),b):(this.map.getView().setCenter([0,0]),this.map.getView().setResolution(39136));break;case"leaflet":a?(c=m(a[0],a[1],"EPSG:900913","EPSG:4326"),d=m(a[2],a[3],"EPSG:900913","EPSG:4326"),this.map.fitBounds([[c.y,c.x],[d.y,d.x]])):this.map.fitWorld()}},this.zoomToExtentOfgeoJsonStore=function(a){switch(n){case"ol2":this.map.zoomToExtent(a.layer.getDataExtent());break;case"leaflet":this.map.fitBounds(a.layer.getBounds())}},this.getBaseLayers=function(a){var b=[];switch(n){case"ol2":for(var c=0;c<this.map.layers.length;c++)this.map.layers[c].isBaseLayer===!0&&(a&&(this.map.layers[c].map=null),b.push(this.map.layers[c]));break;case"leaflet":var d=this.map._layers;for(var e in d)d.hasOwnProperty(e)&&d[e].baseLayer===!0&&b.push(d)}return b},this.getActiveBaseLayer=function(){var a=c._layers;for(var b in a)if(a.hasOwnProperty(b)){var d=a[b];if(!d.overlay&&c._map.hasLayer(d.layer))return d}throw new Error("Control doesn't have any active base layer!")},this.getVisibleLayers=function(a){a=a===!0?!0:!1;var b,c=[];switch(n){case"ol2":for(b=0;b<this.map.layers.length;b++)this.map.layers[b].isBaseLayer!==a&&this.map.layers[b].isBaseLayer!==!1&&null!==this.map.layers[b].isBaseLayer||this.map.layers[b].visibility!==!0||"OpenLayers.Layer.WMS"!==this.map.layers[b].CLASS_NAME||c.push(this.map.layers[b].params.LAYERS);break;case"ol3":for(b=0;b<this.map.getLayers().getLength();b++)this.map.getLayers().a[b].e.visible===!0&&this.map.getLayers().a[b].baseLayer!==!0&&c.push(this.map.getLayers().a[b].id);break;case"leaflet":var d=this.map._layers;for(var e in d)d.hasOwnProperty(e)&&(d[e].baseLayer!==a&&d[e].baseLayer!==!1&&null!==d[e].baseLayer||"object"!=typeof d[e]._tiles||c.push(d[e].id))}return c.join(";")},this.getNamesOfVisibleLayers=function(){var a,b=[];switch(n){case"ol2":for(a=0;a<this.map.layers.length;a++)this.map.layers[a].isBaseLayer===!1&&this.map.layers[a].visibility===!0&&"OpenLayers.Layer.WMS"===this.map.layers[a].CLASS_NAME&&b.push(this.map.layers[a].name);break;case"ol3":for(a=0;a<this.map.getLayers().getLength();a++)this.map.getLayers().a[a].t.visible===!0&&this.map.getLayers().a[a].baseLayer!==!0&&b.push(this.map.getLayers().a[a].id);break;case"leaflet":var c=this.map._layers;for(var d in c)c.hasOwnProperty(d)&&c[d].baseLayer!==!0&&"object"==typeof c[d]._tiles&&b.push(c[d].id)}return b.length>0?b.join(","):!1},this.getBaseLayer=function(){return this.map.baseLayer},this.getBaseLayerName=function(){var a,b;switch(n){case"ol2":a=this.map.baseLayer.name;break;case"ol3":b=this.map.getLayers();for(var c=0;c<b.getLength();c++)b.a[c].t.visible===!0&&b.a[c].baseLayer===!0&&(a=this.map.getLayers().a[c].id);break;case"leaflet":b=this.map._layers;for(var d in b)b.hasOwnProperty(d)&&b[d].baseLayer===!0&&(a=b[d].id)}return a},this.getZoom=function(){var a;switch(n){case"ol2":a=this.map.getZoom();break;case"ol3":var b=this.getResolution();a=Math.round(Math.log(2*Math.PI*6378137/(256*b))/Math.LN2);break;case"leaflet":a=this.map.getZoom()}return a},this.getResolution=function(){return this.map.getView().getResolution()},this.getPixelCoord=function(a,b){var c={};return c.x=this.map.getPixelFromLonLat(new OpenLayers.LonLat(a,b)).x,c.y=this.map.getPixelFromLonLat(new OpenLayers.LonLat(a,b)).y,c},this.zoomToPoint=function(a,b,c){switch(n){case"ol2":this.map.setCenter(new OpenLayers.LonLat(a,b),c);break;case"ol3":this.map.getView().setCenter([a,b]);var d;d=2*Math.PI*6378137/(256*Math.pow(2,c)),this.map.getView().setResolution(d);break;case"leaflet":var e=m(a,b,"EPSG:900913","EPSG:4326");this.map.setView([e.y,e.x],c)}},this.setView=function(a,b){this.map.setView(a,b)},n){case"ol2":var f=[new OpenLayers.Control.Zoom,new OpenLayers.Control.Attribution,new OpenLayers.Control.TouchNavigation({dragPanOptions:{enableKinetic:!0}})];e.showLayerSwitcher&&f.push(new OpenLayers.Control.LayerSwitcher),this.map=new OpenLayers.Map(e.el,{controls:f,numZoomLevels:e.numZoomLevels,resolutions:e.resolutions,projection:e.projection,maxExtent:e.maxExtent,eventListeners:e.eventListeners});break;case"ol3":this.map=new ol.Map({target:e.el,view:new ol.View2D({})});break;case"leaflet":this.map=new L.map(e.el,e),c=L.control.layers([],[]),this.map.addControl(c),this.map.attributionControl.setPrefix(I)}this.map;this.addLayer=function(a,b,d){d?c.addBaseLayer(a,b):c.addOverlay(a,b)},this.addMapQuestOSM=function(){switch(n){case"ol2":this.mapQuestOSM=new OpenLayers.Layer.OSM("mapQuestOSM"),this.mapQuestOSM.wrapDateLine=!1,this.map.addLayer(this.mapQuestOSM),this.mapQuestOSM.setVisibility(!1);break;case"ol3":this.mapQuestOSM=new ol.layer.TileLayer({source:new ol.source.OSM,visible:!1}),this.map.addLayer(this.mapQuestOSM);break;case"leaflet":this.mapQuestOSM=new L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",maxZoom:20,maxNativeZoom:18}),c.addBaseLayer(this.mapQuestOSM,"MapQuest OSM")}return this.mapQuestOSM.baseLayer=!0,this.mapQuestOSM.id="mapQuestOSM",this.mapQuestOSM},this.addMapQuestAerial=function(){switch(n){case"ol2":this.mapQuestAerial=new OpenLayers.Layer.OSM("mapQuestAerial",["http://oatile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg","http://oatile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg","http://oatile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg","http://oatile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg"]),this.mapQuestAerial.wrapDateLine=!1,this.map.addLayer(this.mapQuestAerial),this.mapQuestAerial.setVisibility(!1);break;case"ol3":this.mapQuestAerial=new ol.layer.TileLayer({source:new ol.source.MapQuestOpenAerial,visible:!1}),this.map.addLayer(this.mapQuestAerial);break;case"leaflet":this.mapQuestAerial=new L.tileLayer("http://oatile1.mqcdn.com/tiles/1.0.0/sat/{z}/{x}/{y}.jpg",{maxZoom:20,maxNativeZoom:18}),c.addBaseLayer(this.mapQuestAerial,"Map Quest Aerial")}return this.mapQuestAerial.baseLayer=!0,this.mapQuestAerial.id="mapQuestAerial",this.mapQuestAerial},this.addOSM=function(){switch(n){case"ol2":this.osm=new OpenLayers.Layer.OSM("osm"),this.osm.wrapDateLine=!1,this.map.addLayer(this.osm),this.osm.setVisibility(!1);break;case"ol3":this.osm=new ol.layer.Tile({source:new ol.source.OSM,visible:!1}),this.map.addLayer(this.osm);break;case"leaflet":this.osm=new L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",maxZoom:20,maxNativeZoom:18}),c.addBaseLayer(this.osm,"OSM")}return this.osm.baseLayer=!0,this.osm.id="osm",this.osm},this.addStamen=function(a){var b,d;switch(a){case"toner":b="stamenToner",d="Stamen Toner";break;case"toner-lite":b="stamenTonerLite",d="Stamen Toner Lite"}switch(n){case"ol2":this.stamenToner=new OpenLayers.Layer.Stamen(a),this.stamenToner.name=b,this.map.addLayer(this.stamenToner),this.stamenToner.setVisibility(!1);break;case"ol3":this.stamenToner=new ol.layer.TileLayer({source:new ol.source.Stamen({layer:a}),visible:!1}),this.map.addLayer(this.stamenToner);break;case"leaflet":try{this.stamenToner=new L.StamenTileLayer(a),c.addBaseLayer(this.stamenToner,d)}catch(e){}}return this.stamenToner.baseLayer=!0,this.stamenToner.id=b,this.stamenToner},this.addMapBoxNaturalEarth=function(){switch(n){case"ol2":this.mapBoxNaturalEarth=new OpenLayers.Layer.XYZ("mapBoxNaturalEarth",["//a.tiles.mapbox.com/v3/mapbox.natural-earth-hypso-bathy/${z}/${x}/${y}.png","//b.tiles.mapbox.com/v3/mapbox.natural-earth-hypso-bathy/${z}/${x}/${y}.png","//c.tiles.mapbox.com/v3/mapbox.natural-earth-hypso-bathy/${z}/${x}/${y}.png","//d.tiles.mapbox.com/v3/mapbox.natural-earth-hypso-bathy/${z}/${x}/${y}.png"]),this.mapBoxNaturalEarth.wrapDateLine=!1,this.map.addLayer(this.mapBoxNaturalEarth),this.mapBoxNaturalEarth.setVisibility(!1);break;case"ol3":this.mapBoxNaturalEarth=new ol.layer.TileLayer({source:new ol.source.OSM,visible:!1}),this.map.addLayer(this.mapBoxNaturalEarth);break;case"leaflet":this.mapBoxNaturalEarth=new L.tileLayer("https://a.tiles.mapbox.com/v3/mapbox.natural-earth-hypso-bathy/{z}/{x}/{y}.png"),c.addBaseLayer(this.mapBoxNaturalEarth,"Mapbox Natural Earth")}return this.mapBoxNaturalEarth.baseLayer=!0,this.mapBoxNaturalEarth.id="mapBoxNaturalEarth",this.mapBoxNaturalEarth},this.addGoogle=function(a){var b,d,e,f=this;switch(a){case"ROADMAP":d="googleStreets",e="Google Streets";break;case"HYBRID":d="googleHybrid",e="Google Hybrid";break;case"SATELLITE":d="googleSatellite",e="Google Satellite";break;case"TERRAIN":d="googleTerrain",e="Google Terrain"}"undefined"!=typeof window.GoogleMapsDirty||"undefined"!=typeof google&&"undefined"!=typeof google.maps?"undefined"==typeof window.GoogleMapsDirty&&window.gc2SetLGoogle():(window.GoogleMapsDirty=!0,jQuery.getScript("https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places&callback=gc2SetLGoogle")),function g(){if("undefined"!=typeof google&&"undefined"!=typeof google.maps&&"undefined"!=typeof google.maps.Map){switch(n){case"ol2":b=new OpenLayers.Layer.Google(d,{type:google.maps.MapTypeId[a],wrapDateLine:!0,numZoomLevels:20,title:e}),f.map.addLayer(b),b.setVisibility(!1),b.baseLayer=!0,b.id=d;break;case"leaflet":b=new L.Google(a),b.baseLayer=!0,c.addBaseLayer(b,e),b.id=d}return K[d]=!0,b}setTimeout(g,50)}()},this.addBing=function(a){var b,d,e;switch(a){case"Road":d="bingRoad",e="Bing Road";break;case"Aerial":d="bingAerial",e="Bing Aerial";break;case"AerialWithLabels":d="bingAerialWithLabels",e="Bing Aerial w Labels"}switch(n){case"ol2":return b=new OpenLayers.Layer.Bing({name:d,wrapDateLine:!0,key:window.bingApiKey||this.bingApiKey,type:a}),this.map.addLayer(b),b.setVisibility(!1),b.baseLayer=!0,b.id=d,b;case"leaflet":return b=new L.BingLayer(this.bingApiKey||window.bingApiKey,{type:a,maxZoom:20,maxNativeZoom:18}),b.baseLayer=!0,c.addBaseLayer(b,e),b.id=d,b}},this.addDigitalGlobe=function(a){var b,d,e,f=this.digitalGlobeKey;switch(a){case"DigitalGlobe:Imagery":d="DigitalGlobe:ImageryTileService",e="Digital Globe"}switch(n){case"ol2":b=new OpenLayers.Layer.XYZ(a,"https://services.digitalglobe.com/earthservice/wmtsaccess?CONNECTID="+f+"&Service=WMTS&REQUEST=GetTile&Version=1.0.0&Format=image/png&Layer="+d+"&TileMatrixSet=EPSG:3857&TileMatrix=EPSG:3857:${z}&TileRow=${y}&TileCol=${x}",{resolutions:J}),this.map.addLayer(b),b.setVisibility(!1);break;case"leaflet":b=new L.TileLayer("https://services.digitalglobe.com/earthservice/wmtsaccess?CONNECTID="+f+"&Service=WMTS&REQUEST=GetTile&Version=1.0.0&Format=image/png&Layer="+d+"&TileMatrixSet=EPSG:3857&TileMatrix=EPSG:3857:{z}&TileRow={y}&TileCol={x}",{maxZoom:20}),c.addBaseLayer(b,e)}return b.baseLayer=!0,b.id=a,b},this.addHere=function(a){var b,d,e;switch(a){case"hereNormalNightGrey":d="normal.night.grey",e="HERE Normal Night Grey";break;case"hereNormalDayGrey":d="normal.day.grey",e="HERE Normal day Grey"}switch(n){case"ol2":b=new OpenLayers.Layer.XYZ(a,"https://1.base.maps.cit.api.here.com/maptile/2.1/maptile/newest/"+d+"/${z}/${x}/${y}/256/png8?app_id="+window.gc2Options.hereApp.App_Id+"&app_code="+window.gc2Options.hereApp.App_Code,{attribution:"&copy; Nokia</span>&nbsp;<a href='http://maps.nokia.com/services/terms' target='_blank' title='Terms of Use' style='color:#333;text-decoration: underline;'>Terms of Use</a></div> <img src='//api.maps.nokia.com/2.2.4/assets/ovi/mapsapi/by_here.png' border='0'>",resolutions:J}),this.map.addLayer(b),b.setVisibility(!1);break;case"leaflet":b=new L.TileLayer("https://{s}.base.maps.cit.api.here.com/maptile/2.1/maptile/newest/"+d+"/{z}/{x}/{y}/256/png8?app_id="+window.gc2Options.hereApp.App_Id+"&app_code="+window.gc2Options.hereApp.App_Code,{maxZoom:20,subdomains:["1","2","3","4"],attribution:"&copy; Nokia</span>&nbsp;<a href='http://maps.nokia.com/services/terms' target='_blank' title='Terms of Use' style='color:#333;text-decoration: underline;'>Terms of Use</a></div> <img src='https://api.maps.nokia.com/2.2.4/assets/ovi/mapsapi/by_here.png' border='0'>"}),c.addBaseLayer(b,e)}return b.baseLayer=!0,b.id=a,b},this.addDtkSkaermkort=function(a,b){var d,e="http://cdn.eu1.mapcentia.com/wms/dk/tilecache/";switch(n){case"ol2":d=new OpenLayers.Layer.TMS(a,e,{layername:b,type:"png",attribution:"&copy; Geodatastyrelsen",resolutions:J,wrapDateLine:!0}),this.map.addLayer(d),d.setVisibility(!1);break;case"leaflet":e=e.replace("cdn.","{s}."),d=new L.TileLayer(e+"1.0.0/"+b+"/{z}/{x}/{y}.png",{tms:!0,subdomains:["cdn1","cdn2","cdn3"],attribution:"&copy; Geodatastyrelsen",maxZoom:20}),c.addBaseLayer(d)}return d.baseLayer=!0,d.id=a,d},this.addDtkSkaermkortUtm=function(a,b){var c,d="dtk_skaermkort"===b?"topo_skaermkort":"topo_skaermkort_daempet",e=new OpenLayers.LonLat(12e4,65e5),f=256,g=256;switch(n){case"ol2":c=new OpenLayers.Layer.WMTS({name:a,url:["http://a.services.kortforsyningen.dk/"+d+"?login=mh1&password=sajas&","http://b.services.kortforsyningen.dk/"+d,"http://c.services.kortforsyningen.dk/"+d],style:"default",layer:b,matrixSet:"View1",format:"image/jpeg",attribution:"&copy; Geodatastyrelsen",params:{login:"mh1",password:"sajas"},matrixIds:[{identifier:"L00",scaleDenominator:1638.4/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:3,matrixHeight:2},{identifier:"L01",scaleDenominator:819.2/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:5,matrixHeight:3},{identifier:"L02",scaleDenominator:409.6/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:9,matrixHeight:3},{identifier:"L03",scaleDenominator:204.8/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:17,matrixHeight:12},{identifier:"L04",scaleDenominator:102.4/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:34,matrixHeight:23},{identifier:"L05",scaleDenominator:51.2/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:68,matrixHeight:46},{identifier:"L06",scaleDenominator:25.6/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:135,matrixHeight:92},{identifier:"L07",scaleDenominator:12.8/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:269,matrixHeight:184},{identifier:"L08",scaleDenominator:6.4/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:538,matrixHeight:397},{identifier:"L09",scaleDenominator:3.2/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:2149,matrixHeight:1465},{identifier:"L10",scaleDenominator:1.6/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:4297,matrixHeight:2930},{identifier:"L11",scaleDenominator:.8/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:4297,matrixHeight:2930},{identifier:"L12",scaleDenominator:.4/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:8594,matrixHeight:5860},{identifier:"L13",scaleDenominator:.2/28e-5,topLeftCorner:e,tileWidth:f,tileHeight:g,matrixWidth:17188,matrixHeight:11719}],isBaseLayer:!0,displayInLayerSwitcher:!0,transitionEffect:"resize"}),this.map.addLayer(c),c.setVisibility(!1);break;case"leaflet":}return c.baseLayer=!0,c.id=a,c},this.addYandex=function(a){var b,d;switch(a){case"map":b="yandexMap",d="Yandex Map";break;case"satellite":b="yandexSatellite",d="Yandex Satellite";break;case"hybrid":b="yandexHybrid",d="Yandex Hybrid";break;case"publicMap":b="yandexPublicMap",d="Yandex Public Map";break;case"publicMapHybrid":b="yandexPublicMapHybrid",d="Yandex Public Map Hybrid"}"undefined"!=typeof window.YandexMapsDirty||"undefined"!=typeof ymaps&&"undefined"!=typeof ymaps.Map||(window.YandexMapsDirty=!0,jQuery.getScript("https://api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-RU")),function e(){if("undefined"!=typeof ymaps&&"undefined"!=typeof ymaps.Map)switch(n){case"leaflet":return this.yandex=new L.Yandex(a),M[b]=!0,c.addBaseLayer(this.yandex,d),this.yandex.baseLayer=!0,this.yandex.id=b,this.yandex}else setTimeout(e,100)}()},this.setBaseLayer=function(a){var b,d=this;!function e(){if(a.search("google")>-1&&void 0!==K[a]||a.search("yandex")>-1&&void 0!==M[a]||-1===a.search("google")&&-1===a.search("yandex"))switch(n){case"ol2":d.showLayer(a),d.map.setBaseLayer(d.getLayersByName(a));break;case"ol3":b=d.map.getLayers();for(var f=0;f<b.getLength();f++)b.a[f].baseLayer===!0&&b.a[f].set("visible",!1);d.getLayersByName(a).set("visible",!0);break;case"leaflet":b=c._layers;for(var g in b)b.hasOwnProperty(g)&&(b[g].layer.baseLayer===!0&&d.map.hasLayer(b[g].layer)&&d.map.removeLayer(b[g].layer),b[g].layer.baseLayer===!0&&b[g].layer.id===a&&(-1===a.search("google")&&-1===a.search("yandex")&&b[g].layer.setZIndex(1),d.map.addLayer(b[g].layer,!1)))}else setTimeout(e,200)}()},this.addBaseLayer=function(a,b){var c;switch(a){case"osm":c=this.addOSM();break;case"mapQuestOSM":c=this.addMapQuestOSM();break;case"addMapQuestAerial":c=this.addMapQuestAerial();break;case"mapBoxNaturalEarth":c=this.addMapBoxNaturalEarth();break;case"stamenToner":c=this.addStamen("toner");break;case"stamenTonerLite":c=this.addStamen("toner-lite");break;case"googleStreets":c=this.addGoogle("ROADMAP");break;case"googleHybrid":c=this.addGoogle("HYBRID");break;case"googleSatellite":c=this.addGoogle("SATELLITE");break;case"googleTerrain":c=this.addGoogle("TERRAIN");break;case"bingRoad":c=this.addBing("Road");break;case"bingAerial":c=this.addBing("Aerial");break;case"bingAerialWithLabels":c=this.addBing("AerialWithLabels");break;case"yandexMap":c=this.addYandex("map");break;case"yandexSatellite":c=this.addYandex("satellite");break;case"yandexHybrid":c=this.addYandex("hybrid");break;case"yandexPublicMap":c=this.addYandex("publicMap");break;case"yandexPublicMapHybrid":c=this.addYandex("publicMapHybrid");break;case"dtkSkaermkort":c=this.addDtkSkaermkort("dtkSkaermkort","dtk_skaermkort");break;case"dtkSkaermkortDaempet":c=this.addDtkSkaermkort("dtkSkaermkortDaempet","dtk_skaermkort_daempet");break;case"dtkSkaermkort@25832":c=this.addDtkSkaermkortUtm("dtkSkaermkort@25832","dtk_skaermkort");break;case"dtkSkaermkortDaempet@25832":c=this.addDtkSkaermkortUtm("dtkSkaermkortDaempet@25832","dtk_skaermkort_daempet");break;case"DigitalGlobe:Imagery":c=this.addDigitalGlobe("DigitalGlobe:Imagery");break;case"hereNormalDayGrey":c=this.addHere("hereNormalDayGrey");break;case"hereNormalNightGrey":c=this.addHere("hereNormalNightGrey");break;default:c=this.addTileLayers({layers:[a],db:b,isBaseLayer:!0,visibility:!1,wrapDateLine:!1,displayInLayerSwitcher:!0,name:a,type:"tms"})}return c},this.addTileLayers=function(a){var d={host:o,layers:[],db:null,singleTile:!1,opacity:1,isBaseLayer:!1,visibility:!0,wrapDateLine:!0,tileCached:!0,displayInLayerSwitcher:!0,name:null,names:[],resolutions:this.map.resolutions,type:"wms"};if(a)for(b in a)d[b]=a[b];for(var e=d.layers,f=[],g=0;g<e.length;g++){var h;switch(d.type){case"wms":h=j(e[g],d);break;case"tms":h=k(e[g],d);break;default:h=j(e[g],d)}switch(h.baseLayer=d.isBaseLayer,n){case"ol2":this.map.addLayer(h);break;case"ol3":this.map.addLayer(h);break;case"leaflet":d.isBaseLayer===!0?c.addBaseLayer(h,d.name||d.names[g]):c.addOverlay(h,d.name||d.names[g]||e[g]),d.visibility===!0&&this.showLayer(e[g])}f.push(h)}return f},this.removeTileLayerByName=function(a){switch(n){case"ol2":var b=this.map.getLayersByName(a);this.map.removeLayer(b[0]);break;case"leaflet":this.map.removeLayer(this.getLayersByName(a)),c.removeLayer(this.getLayersByName(a))}},this.setZIndexOfLayer=function(a,b){switch(n){case"ol2":break;case"leaflet":a.setZIndex(b)}},this.addGeoJsonStore=function(a){switch(a.map=this,n){case"ol2":this.map.addLayers([a.layer]);break;case"ol3":this.map.addLayer(a.layer);break;case"leaflet":c.addOverlay(a.layer,a.name),this.showLayer(a.layer.id)}},this.addHeatMap=function(a,b,c,d){var e=[],f=a.geoJSON.features;b=b||1,c=c||1,d=d||{};for(var g in f)f.hasOwnProperty(g)&&(f[g].geometry.coordinates.reverse(),f[g].geometry.coordinates.push(f[g].properties[b]*c+""),e.push(f[g].geometry.coordinates));a.layer=L.heatLayer(e,d),this.addGeoJsonStore(a)},this.removeGeoJsonStore=function(a){switch(n){case"ol2":this.map.removeLayer(a.layer);break;case"leaflet":this.map.removeLayer(a.layer)}},this.hideLayer=function(a){switch(n){case"ol2":this.getLayersByName(a).setVisibility(!1);break;case"ol3":this.getLayersByName(a).set("visible",!1);break;case"leaflet":this.map.removeLayer(this.getLayersByName(a))}},this.showLayer=function(a){switch(n){case"ol2":this.getLayersByName(a).setVisibility(!0);break;case"ol3":this.getLayersByName(a).set("visible",!0);break;case"leaflet":this.getLayersByName(a).addTo(this.map)}},this.getLayerById=function(a){return this.map.getLayer(a)},this.getLayersByName=function(a){var b;switch(n){case"ol2":b=this.map.getLayersByName(a)[0];break;case"ol3":for(var d=0;d<this.map.getLayers().getLength();d++)this.map.getLayers().a[d].id===a&&(b=this.map.getLayers().a[d]);break;case"leaflet":var e=c._layers;for(var f in e)e.hasOwnProperty(f)&&e[f].layer.id===a&&(b=e[f].layer)}return b},this.hideAllTileLayers=function(){for(var a=0;a<this.map.layers.length;a++)this.map.layers[a].isBaseLayer===!1&&"OpenLayers.Layer.WMS"===this.map.layers[a].CLASS_NAME&&this.map.layers[a].setVisibility(!1)},this.getCenter=function(){var a;switch(n){case"ol2":return a=this.map.center,{x:a.lon,y:a.lat};case"ol3":return a=this.map.getView().getCenter(),{x:a[0],y:a[1]};case"leaflet":a=this.map.getCenter();var b=m(a.lng,a.lat,"EPSG:4326","EPSG:900913");return{x:b.x,y:b.y,lon:a.lng,lat:a.lat}}},this.getExtent=function(){var a,b;switch(n){case"ol2":a=this.map.getExtent(),b=a.toArray();break;case"ol3":break;case"leaflet":a=this.map.getBounds().toBBoxString().split(","),b={left:a[0],right:a[2],top:a[3],bottom:a[1]}
}return b},this.getBbox=function(){return this.map.getExtent().toString()},this.locate=function(){this.map.locate({setView:!0})},this.addLayerFromWkt=function(a){switch(n){case"ol2":this.removeQueryLayers();for(var b,c,e,f=new OpenLayers.Format.WKT,g=0;g<a.length;g++)b=f.read(a[g]),d[g]=new OpenLayers.Layer.Vector(null,{displayInLayerSwitcher:!1,styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({strokeColor:"#000000",strokeWidth:3,fillOpacity:0,strokeOpacity:.8})})}),c=b.geometry.transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:900913")),e=new OpenLayers.Feature.Vector(c,{}),d[g].addFeatures([e]),this.map.addLayers([d[g]]);break;case"ol3":break;case"leaflet":this.removeQueryLayers();for(var f=new Wkt.Wkt,g=0;g<a.length;g++)f.read(a[g]),d[g]=f.toObject({color:"#000000",weight:3,opacity:.8,fillOpacity:0}).addTo(this.map)}},this.removeQueryLayers=function(){switch(n){case"ol2":try{for(var a=0;a<d.length;a++)this.map.removeLayer(d[a])}catch(b){}break;case"ol3":break;case"leaflet":try{for(var a=0;a<d.length;a++)this.map.removeLayer(d[a])}catch(b){}}},this.on=function(a,b){switch(n){case"ol2":if("click"===a){OpenLayers.Control.Click=OpenLayers.Class(OpenLayers.Control,{defaultHandlerOptions:{single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1},initialize:function(){this.handlerOptions=OpenLayers.Util.extend({},this.defaultHandlerOptions),OpenLayers.Control.prototype.initialize.apply(this,arguments),this.handler=new OpenLayers.Handler.Click(this,{click:this.trigger},this.handlerOptions)},trigger:function(a){b(a)}});var c=new OpenLayers.Control.Click;this.map.addControl(c),c.activate()}"moveend"===a&&this.map.events.register("moveend",null,b);break;case"ol3":this.map.on(a,b);break;case"leaflet":this.map.on(a,b)}}},l=function(a,b){this.getCoordinate=function(){var c;switch(n){case"ol2":return c=b.map.getLonLatFromPixel(a.xy),{x:c.lon,y:c.lat};case"ol3":return c=a.coordinate,{x:c[0],y:c[1]};case"leaflet":c=a.latlng;var d=m(c.lng,c.lat,"EPSG:4326","EPSG:900913");return{x:d.x,y:d.y}}}},m=function(a,b,c,d){var e=[];if("object"==typeof Proj4js){var f=new Proj4js.Proj(c),g=new Proj4js.Proj(d);e=new Proj4js.Point(a,b),Proj4js.transform(f,g,e)}else e.x=null,e.y=null;return e},{geoJsonStore:d,sqlStore:f,tileLayer:i,elasticStore:h,tweetStore:g,cartoDbStore:e,map:a,MAPLIB:n,clickEvent:l,transformPoint:m,urlVars:function(){{var a={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d})}return a}(),pathName:window.location.pathname.split("/"),urlHash:window.location.hash,OSM:q,MAPQUESTOSM:r,MAPBOXNATURALEARTH:s,STAMENTONER:t,STAMENTONERLITE:u,GOOGLESTREETS:v,GOOGLEHYBRID:w,GOOGLESATELLITE:x,GOOGLETERRAIN:y,BINGROAD:z,BINGAERIAL:A,BINGAERIALWITHLABELS:B,DTKSKAERMKORT:D,DTKSKAERMKORT_25832:C,DTKSKAERMKORTDAEMPET:E,DIGITALGLOBE:F,HERENORMALDAYGREY:G,HERENORMALNIGHTGREY:H,setHost:N}}(),function(a){"use strict";var b=" a. b. c. d.".split(" "),c=function(a,c,d,e){return{url:["https://stamen-tiles.a.ssl.fastly.net/",a,"/{Z}/{X}/{Y}.",c].join(""),type:c,subdomains:b.slice(),minZoom:d,maxZoom:e,attribution:['Map tiles by <a href="http://stamen.com">Stamen Design</a>, ','under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. ','Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, ','under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.'].join("")}},d={toner:c("toner","png",0,21),terrain:c("terrain","jpg",4,18),watercolor:c("watercolor","jpg",1,18)},e=function(a){if(a in d)return d[a];throw"No such provider ("+a+")"},f=function(a,b,f){for(var g=e(a),h=0;h<b.length;h++){var i=[a,b[h]].join("-");d[i]=c(i,f||g.type,g.minZoom,g.maxZoom)}};if(f("toner",["hybrid","labels","lines","background","lite"]),f("toner",["2010"]),f("toner",["2011","2011-lines","2011-labels","2011-lite"]),f("terrain",["background"]),f("terrain",["labels","lines"],"png"),a.stamen=a.stamen||{},a.stamen.tile=a.stamen.tile||{},a.stamen.tile.providers=d,a.stamen.tile.getProvider=e,"object"==typeof L&&(L.StamenTileLayer=L.TileLayer.extend({initialize:function(a){var b=e(a),c=b.url.replace(/({[A-Z]})/g,function(a){return a.toLowerCase()});L.TileLayer.prototype.initialize.call(this,c,{minZoom:b.minZoom,maxZoom:b.maxZoom,subdomains:b.subdomains,scheme:"xyz",attribution:b.attribution})}})),"object"==typeof OpenLayers){var g=function(a){return a.replace(/({.})/g,function(a){return"$"+a.toLowerCase()})};OpenLayers.Layer.Stamen=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(a,b){var c=e(a),d=c.url,f=c.subdomains,h=[];if(d.indexOf("{S}")>-1)for(var i=0;i<f.length;i++)h.push(g(d.replace("{S}",f[i])));else h.push(g(d));return b=OpenLayers.Util.extend({numZoomLevels:c.maxZoom,buffer:0,transitionEffect:"resize",tileOptions:{crossOriginKeyword:null}},b),OpenLayers.Layer.OSM.prototype.initialize.call(this,a,h,b)}})}}("undefined"==typeof exports?this:exports),"leaflet"===geocloud.MAPLIB&&(L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(a,b){L.Util.setOptions(this,b),this._key=a,this._url=null,this.meta={},this.loadMetadata()},tile2quad:function(a,b,c){for(var d="",e=c;e>0;e--){var f=0,g=1<<e-1;0!=(a&g)&&(f+=1),0!=(b&g)&&(f+=2),d+=f}return d},getTileUrl:function(a,b){var b=this._getZoomForUrl(),c=this.options.subdomains,d=this.options.subdomains[Math.abs((a.x+a.y)%c.length)];return this._url.replace("{subdomain}",d).replace("http:","https:").replace("{quadkey}",this.tile2quad(a.x,a.y,b)).replace("{culture}",this.options.culture)},loadMetadata:function(){var a=this,b="_bing_metadata_"+L.Util.stamp(this);window[b]=function(c){a.meta=c,window[b]=void 0;var d=document.getElementById(b);return d.parentNode.removeChild(d),c.errorDetails?void alert("Got metadata"+c.errorDetails):void a.initMetadata()};var c="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+b+"&key="+this._key,d=document.createElement("script");d.type="text/javascript",d.src=c,d.id=b,document.getElementsByTagName("head")[0].appendChild(d)},initMetadata:function(){var a=this.meta.resourceSets[0].resources[0];this.options.subdomains=a.imageUrlSubdomains,this._url=a.imageUrl,this._providers=[];for(var b=0;b<a.imageryProviders.length;b++)for(var c=a.imageryProviders[b],d=0;d<c.coverageAreas.length;d++){var e=c.coverageAreas[d],f={zoomMin:e.zoomMin,zoomMax:e.zoomMax,active:!1},g=new L.LatLngBounds(new L.LatLng(e.bbox[0]+.01,e.bbox[1]+.01),new L.LatLng(e.bbox[2]-.01,e.bbox[3]-.01));f.bounds=g,f.attrib=c.attribution,this._providers.push(f)}this._update()},_update:function(){null!=this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var a=this._map.getBounds(),b=this._map.getZoom(),c=0;c<this._providers.length;c++){var d=this._providers[c];b<=d.zoomMax&&b>=d.zoomMin&&a.intersects(d.bounds)?(d.active||this._map.attributionControl.addAttribution(d.attrib),d.active=!0):(d.active&&this._map.attributionControl.removeAttribution(d.attrib),d.active=!1)}},onRemove:function(a){for(var b=0;b<this._providers.length;b++){var c=this._providers[b];c.active&&(this._map.attributionControl.removeAttribution(c.attrib),c.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[a])}}),function(a,b){"use strict";L.AwesomeMarkers={},L.AwesomeMarkers.version="2.0.1",L.AwesomeMarkers.Icon=L.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],shadowAnchor:[10,12],shadowSize:[36,16],className:"awesome-marker",prefix:"glyphicon",spinClass:"fa-spin",icon:"home",markerColor:"blue",iconColor:"white"},initialize:function(a){a=L.Util.setOptions(this,a)},createIcon:function(){var a=b.createElement("div"),c=this.options;return c.icon&&(a.innerHTML=this._createInner()),c.bgPos&&(a.style.backgroundPosition=-c.bgPos.x+"px "+-c.bgPos.y+"px"),this._setIconStyles(a,"icon-"+c.markerColor),a},_createInner:function(){var a,b="",c="",d="",e=this.options;return a=e.icon.slice(0,e.prefix.length+1)===e.prefix+"-"?e.icon:e.prefix+"-"+e.icon,e.spin&&"string"==typeof e.spinClass&&(b=e.spinClass),e.iconColor&&("white"===e.iconColor||"black"===e.iconColor?c="icon-"+e.iconColor:d="style='color: "+e.iconColor+"' "),"<i "+d+"class='"+e.prefix+" "+a+" "+b+" "+c+"'></i>"},_setIconStyles:function(a,b){var c,d=this.options,e=L.point(d["shadow"===b?"shadowSize":"iconSize"]);c=L.point("shadow"===b?d.shadowAnchor||d.iconAnchor:d.iconAnchor),!c&&e&&(c=e.divideBy(2,!0)),a.className="awesome-marker-"+b+" "+d.className,c&&(a.style.marginLeft=-c.x+"px",a.style.marginTop=-c.y+"px"),e&&(a.style.width=e.x+"px",a.style.height=e.y+"px")},createShadow:function(){var a=b.createElement("div");return this._setIconStyles(a,"shadow"),a}}),L.AwesomeMarkers.icon=function(a){return new L.AwesomeMarkers.Icon(a)}}(this,document));var gc2SetLGoogle=function(){"leaflet"===geocloud.MAPLIB&&(L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:20,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,mapOptions:{backgroundColor:"#dddddd"}},initialize:function(a,b){L.Util.setOptions(this,b),this._ready=void 0!=google.maps.Map,this._ready||L.Google.asyncWait.push(this),this._type=a||"SATELLITE"},onAdd:function(a,b){this._map=a,this._insertAtTheBottom=b,this._initContainer(),this._initMapObject(),a.on("viewreset",this._resetCallback,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this),a.on("move",this._update,this),a.on("zoomanim",this._handleZoomAnim,this),a._controlCorners.bottomright.style.marginBottom="20px",this._reset(),this._update()},onRemove:function(a){this._map._container.removeChild(this._container),this._map.off("viewreset",this._resetCallback,this),this._map.off("move",this._update,this),this._map.off("zoomanim",this._handleZoomAnim,this),a._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(a){this.options.opacity=a,1>a&&L.DomUtil.setOpacity(this._container,a)},setElementSize:function(a,b){a.style.width=b.x+"px",a.style.height=b.y+"px"},_initContainer:function(){var a=this._map._container,b=a.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),a.insertBefore(this._container,b),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=new google.maps.LatLng(0,0);var a=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.mapOptions.styles,backgroundColor:this.options.mapOptions.backgroundColor}),b=this;this._reposition=google.maps.event.addListenerOnce(a,"center_changed",function(){b.onReposition()}),this._google=a,google.maps.event.addListenerOnce(a,"idle",function(){b._checkZoomLevels()})}},_checkZoomLevels:function(){this._google.getZoom()!==this._map.getZoom()&&this._map.setZoom(this._google.getZoom())},_resetCallback:function(a){this._reset(a.hard)},_reset:function(){this._initContainer()},_update:function(a){if(this._google){this._resize();var b=a&&a.latlng?a.latlng:this._map.getCenter(),c=new google.maps.LatLng(b.lat,b.lng);this._google.setCenter(c),this._google.setZoom(this._map.getZoom()),this._checkZoomLevels()}},_resize:function(){var a=this._map.getSize();(this._container.style.width!=a.x||this._container.style.height!=a.y)&&(this.setElementSize(this._container,a),this.onReposition())},_handleZoomAnim:function(a){var b=a.center,c=new google.maps.LatLng(b.lat,b.lng);this._google.setCenter(c),this._google.setZoom(a.zoom)},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[],L.Google.asyncInitialize=function(){var a;for(a=0;a<L.Google.asyncWait.length;a++){var b=L.Google.asyncWait[a];b._ready=!0,b._container&&(b._initMapObject(),b._update())}L.Google.asyncWait=[]})};"leaflet"===geocloud.MAPLIB&&(L.Yandex=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,attribution:"",opacity:1,traffic:!1},initialize:function(a,b){L.Util.setOptions(this,b),this._type="yandex#"+(a||"map")},onAdd:function(a,b){this._map=a,this._insertAtTheBottom=b,this._initContainer(),this._initMapObject(),a.on("viewreset",this._resetCallback,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this),a.on("move",this._update,this),a._controlCorners.bottomright.style.marginBottom="3em",this._reset(),this._update(!0)},onRemove:function(a){this._map._container.removeChild(this._container),this._map.off("viewreset",this._resetCallback,this),this._map.off("move",this._update,this),a._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(a){this.options.opacity=a,1>a&&L.DomUtil.setOpacity(this._container,a)},setElementSize:function(a,b){a.style.width=b.x+"px",a.style.height=b.y+"px"},_initContainer:function(){var a=this._map._container,b=a.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-yandex-layer leaflet-top leaflet-left"),this._container.id="_YMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),this.options.overlay&&(b=this._map._container.getElementsByClassName("leaflet-map-pane")[0],b=b.nextSibling,L.Browser.opera&&(this._container.className+=" leaflet-objects-pane")),a.insertBefore(this._container,b),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(!this._yandex){if(void 0===ymaps.Map)return console&&console.debug("L.Yandex: Waiting on ymaps.load('package.map')"),ymaps.load(["package.map"],this._initMapObject,this);if(this.options.traffic&&(void 0===ymaps.control||void 0===ymaps.control.TrafficControl))return console&&console.debug("L.Yandex: loading traffic and controls"),ymaps.load(["package.traffic","package.controls"],this._initMapObject,this);var a=new ymaps.Map(this._container,{center:[0,0],zoom:0,behaviors:[]});this.options.traffic&&a.controls.add(new ymaps.control.TrafficControl({shown:!0})),"yandex#null"==this._type&&(this._type=new ymaps.MapType("null",[]),a.container.getElement().style.background="transparent"),a.setType(this._type),this._yandex=a,this._update(!0)}},_resetCallback:function(a){this._reset(a.hard)},_reset:function(){this._initContainer()},_update:function(a){if(this._yandex){this._resize(a);var b=this._map.getCenter(),c=[b.lat,b.lng],d=this._map.getZoom();(a||this._yandex.getZoom()!=d)&&this._yandex.setZoom(d),this._yandex.panTo(c,{duration:0,delay:0})}},_resize:function(a){var b=this._map.getSize(),c=this._container.style;if(c.width!=b.x+"px"||c.height!=b.y+"px"||1==a){this.setElementSize(this._container,b);{var d=this._map.getBounds();d.getSouthWest(),d.getNorthEast()}this._yandex.container.fitToViewport()}}}));